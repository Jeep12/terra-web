import{b as be,d as he,g as Ce,s as xe}from"./chunk-XKQTFA3I.js";import{a as ue}from"./chunk-ORXIPCW4.js";import{b as te,c as ne,d as oe,f as ae,h as re,k as ie,l as A,m as se,n as pe,o as de,p as le,q as ce,s as me,t as ge,w as fe,x as I,y as _}from"./chunk-EOPBSBBR.js";import{Ab as S,B as h,Bb as E,Cb as T,Eb as g,Fb as Y,Ia as V,Ib as G,Jb as $,Kb as J,N as L,Nb as R,Ob as X,Pa as s,Q as j,Qb as Z,R as U,Tb as q,V as z,Vb as ee,W as m,Za as y,_a as W,aa as C,ba as x,cb as P,d as b,kb as p,mb as K,o as D,p as O,pb as r,qb as i,rb as d,s as N,t as F,ub as Q,xb as k}from"./chunk-7JUKLSWG.js";var ye=(e,t)=>{let n=m(ue),o=m(ge);return n.isLoggedIn().pipe(L(a=>{a||o.navigate(["/login"])}),F(a=>a),h(()=>(o.navigate(["/login"]),D(!1))))};var H=[{path:"",loadComponent:()=>import("./chunk-PYJLTANW.js").then(e=>e.WebsiteComponent),children:[{path:"",redirectTo:"home",pathMatch:"full"},{path:"home",loadComponent:()=>import("./chunk-2OZGHF37.js").then(e=>e.HomeComponent)},{path:"gallery",loadComponent:()=>import("./chunk-TO3LL7QE.js").then(e=>e.GalleryComponent)}]},{path:"login",loadComponent:()=>import("./chunk-LAVC6OSZ.js").then(e=>e.LoginComponent)},{path:"register",loadComponent:()=>import("./chunk-4ZZVRM3E.js").then(e=>e.RegisterComponent)},{path:"reset-password",loadComponent:()=>import("./chunk-COLW2D6V.js").then(e=>e.ResetPasswordComponent)},{path:"forgot-password",loadComponent:()=>import("./chunk-Y6C7NHNA.js").then(e=>e.ForgotPasswordComponent)},{path:"resend-email-verification",loadComponent:()=>import("./chunk-ZRQLVW3J.js").then(e=>e.ResendEmailVerificationComponent)},{path:"verify-email",loadComponent:()=>import("./chunk-O3DURIXV.js").then(e=>e.VerifyEmailComponent)},{path:"two-factor-step",loadComponent:()=>import("./chunk-VEAGQJSB.js").then(e=>e.TwoFactorComponent)},{path:"dashboard",loadComponent:()=>import("./chunk-Y6QV6I2X.js").then(e=>e.Dashboard2Component),canActivate:[ye],children:[{path:"",pathMatch:"full",redirectTo:"create-account-game"},{path:"home-dashboard",loadComponent:()=>import("./chunk-RKEOZQ2C.js").then(e=>e.DashboardHomeComponent)},{path:"create-account-game",loadComponent:()=>import("./chunk-DY3SICDA.js").then(e=>e.CreateAccountGameComponent)},{path:"change-password-game",loadComponent:()=>import("./chunk-W6HLCQSH.js").then(e=>e.ChangePasswordGameComponent)},{path:"buy-terra-coin",loadComponent:()=>import("./chunk-DYIBWPF4.js").then(e=>e.BuyTerraCoinComponent)},{path:"send-terra-coin",loadComponent:()=>import("./chunk-BV52T3AT.js").then(e=>e.SendTerraCoinComponent)},{path:"support",loadComponent:()=>import("./chunk-EEB4RJMH.js").then(e=>e.SupportComponent)},{path:"download",loadComponent:()=>import("./chunk-R6VTMSNE.js").then(e=>e.DownloadComponent)},{path:"setting-account-master",loadComponent:()=>import("./chunk-RVEQMR64.js").then(e=>e.SettingsAccountMasterComponent)}]},{path:"**",loadComponent:()=>import("./chunk-3UBUMVZV.js").then(e=>e.WebsiteNotFoundComponent)}],_e=class e{static \u0275fac=function(n){return new(n||e)};static \u0275mod=W({type:e});static \u0275inj=U({imports:[I.forRoot(H),I]})};var ve=(e,t)=>{let n=localStorage.getItem("deviceId")||"",o=e.url.includes("n8n.l2terra.online"),a=e.url.includes("/api/auth/me"),u=o?e.headers:e.headers.set("X-Device-Id",n),l=e.clone({withCredentials:!o,headers:u});return t(l).pipe(h(c=>{if(a&&(c.status===401||c.status===403)){let f=new Error;return f.name="SilentAuthError",f.message=c.message,f.stack=c.stack,Object.defineProperty(f,"status",{value:c.status,writable:!1}),Object.defineProperty(f,"error",{value:c.error,writable:!1}),O(()=>f)}return O(()=>c)}))};var Me={providers:[q({eventCoalescing:!0}),fe(H),pe(le(),de([ve]))]};var v=class e{constructor(t){this.http=t}WEBHOOK_URL=_.WEBHOOK_URL_N8N;AUTH_USERNAME=_.AUTH_USERNAME_N8N;AUTH_PASSWORD=_.AUTH_PASSWORD_N8N;sendMessageAsync(t){return b(this,null,function*(){let n={sessionId:"asdasdsa",message:t,timestamp:new Date().toISOString(),action:"sendMessage"},o=new A({"Content-Type":"application/json",Authorization:"Basic "+btoa(`${this.AUTH_USERNAME}:${this.AUTH_PASSWORD}`)});try{return yield N(this.http.post(this.WEBHOOK_URL,n,{headers:o,withCredentials:!1}))}catch(a){throw console.error("Error al enviar mensaje:",a),a}})}sendMessage(t){let n={sessionId:"asdasdsa",message:t,timestamp:new Date().toISOString(),action:"sendMessage"},o=new A({"Content-Type":"application/json",Authorization:"Basic "+btoa(`${this.AUTH_USERNAME}:${this.AUTH_PASSWORD}`)});return this.http.post(this.WEBHOOK_URL,n,{headers:o,withCredentials:!1})}static \u0275fac=function(n){return new(n||e)(z(se))};static \u0275prov=j({token:e,factory:e.\u0275fac,providedIn:"root"})};var Oe=["messagesContainer"],Pe=["messageInput"],ke=(e,t)=>({"user-wrapper":e,"bot-wrapper":t}),Se=(e,t)=>({"user-message":e,"bot-message":t});function Ee(e,t){e&1&&(r(0,"div",13)(1,"h3"),g(2,"Hello! \u{1F44B}"),i(),r(3,"p"),g(4,"How can I help you today?"),i()())}function Te(e,t){if(e&1&&(r(0,"div",14)(1,"div",15)(2,"div",16),d(3,"div",17),r(4,"div",18),g(5),X(6,"date"),i()()()()),e&2){let n=t.$implicit;p("ngClass",R(7,ke,n.sender==="user",n.sender==="bot")),s(),p("ngClass",R(10,Se,n.sender==="user",n.sender==="bot")),s(2),p("innerHTML",n.text,V),s(2),Y(Z(6,4,n.timestamp,"shortTime"))}}function Re(e,t){e&1&&(r(0,"div",19)(1,"div",20)(2,"div",21),d(3,"span")(4,"span")(5,"span"),i(),r(6,"span",22),g(7,"Typing..."),i()()())}function Ae(e,t){e&1&&(r(0,"span",23),d(1,"i",24),i())}function Ie(e,t){e&1&&(r(0,"span",25),d(1,"i",26),i())}var M=class e{messagesContainer;messageInput;msg="";messages=[];isLoading=!1;shouldScrollToBottom=!1;chatbotService=m(v);cdRef=m(ee);sanitizer=m(ce);ngAfterViewChecked(){this.shouldScrollToBottom&&(this.scrollToBottom(),this.shouldScrollToBottom=!1)}sendMessage(){return b(this,null,function*(){let t=this.msg.trim();if(!(!t||this.isLoading)){this.addMessage(t,"user"),this.msg="",this.isLoading=!0,this.shouldScrollToBottom=!0,setTimeout(()=>{this.messageInput?.nativeElement?.focus()},100);try{let n=yield this.chatbotService.sendMessageAsync(t),o=this.extractBotResponse(n);this.addMessage(o,"bot"),console.log("Respuesta del bot:",o),console.log("Respuesta completa:",n)}catch(n){this.addMessage("Error al conectar con el servicio","bot"),console.error("Error:",n)}finally{this.isLoading=!1,this.shouldScrollToBottom=!0,this.forceViewUpdate()}}})}onKeyPress(t){t.key==="Enter"&&!t.shiftKey&&(t.preventDefault(),this.sendMessage())}addMessage(t,n){let o=n==="bot"?this.sanitizer.bypassSecurityTrustHtml(t.replace(/\n/g,"<br>")):t;this.messages=[...this.messages,{text:o,sender:n,timestamp:new Date}],this.shouldScrollToBottom=!0,this.cdRef.detectChanges()}extractBotResponse(t){return t?.output||t?.reply||t?.message||t?.data?.message||t?.result||JSON.stringify(t)||"Recib\xED tu mensaje"}forceViewUpdate(){this.cdRef.detectChanges()}scrollToBottom(){if(this.messagesContainer?.nativeElement){let t=this.messagesContainer.nativeElement;t.scrollTop=t.scrollHeight}}trackByMessage(t,n){return t}static \u0275fac=function(n){return new(n||e)};static \u0275cmp=y({type:e,selectors:[["app-botterra"]],viewQuery:function(n,o){if(n&1&&(S(Oe,5),S(Pe,5)),n&2){let a;E(a=T())&&(o.messagesContainer=a.first),E(a=T())&&(o.messageInput=a.first)}},decls:13,vars:11,consts:[["messagesContainer",""],["messageInput",""],[1,"chatbot-container"],[1,"messages-container"],["class","welcome-message",4,"ngIf"],["class","message-wrapper",3,"ngClass",4,"ngFor","ngForOf","ngForTrackBy"],["class","loading-wrapper",4,"ngIf"],[1,"input-container"],[1,"input-wrapper"],["placeholder","Type your message...","name","message","autocomplete","off",1,"message-input",3,"ngModelChange","keypress","ngModel","disabled"],[1,"send-button",3,"click","disabled"],["class","send-icon",4,"ngIf"],["class","loading-spinner",4,"ngIf"],[1,"welcome-message"],[1,"message-wrapper",3,"ngClass"],[1,"message",3,"ngClass"],[1,"message-content"],[1,"message-text",3,"innerHTML"],[1,"message-time"],[1,"loading-wrapper"],[1,"loading-message"],[1,"typing-indicator"],[1,"typing-text"],[1,"send-icon"],[1,"fa-solid","fa-paper-plane"],[1,"loading-spinner"],[1,"fa-solid","fa-circle-notch","fa-spin"]],template:function(n,o){if(n&1){let a=Q();r(0,"div",2)(1,"div",3,0),P(3,Ee,5,0,"div",4)(4,Te,7,13,"div",5)(5,Re,8,0,"div",6),i(),r(6,"div",7)(7,"div",8)(8,"input",9,1),J("ngModelChange",function(l){return C(a),$(o.msg,l)||(o.msg=l),x(l)}),k("keypress",function(l){return C(a),x(o.onKeyPress(l))}),i(),r(10,"button",10),k("click",function(){return C(a),x(o.sendMessage())}),P(11,Ae,2,0,"span",11)(12,Ie,2,0,"span",12),i()()()()}n&2&&(s(3),p("ngIf",o.messages.length===0),s(),p("ngForOf",o.messages)("ngForTrackBy",o.trackByMessage),s(),p("ngIf",o.isLoading),s(3),G("ngModel",o.msg),p("disabled",o.isLoading),s(2),K("loading",o.isLoading),p("disabled",!o.msg.trim()||o.isLoading),s(),p("ngIf",!o.isLoading),s(),p("ngIf",o.isLoading))},dependencies:[re,te,ne,oe,ae,xe,be,he,Ce],styles:['.chatbot-container[_ngcontent-%COMP%]{display:flex;flex-direction:column;height:100%;background:linear-gradient(135deg,#0a0e1a,#1a1f2e,#000);border-radius:16px;overflow:hidden;box-shadow:0 20px 40px #0000004d;position:relative}.chatbot-container[_ngcontent-%COMP%]:before{content:"";position:absolute;top:0;left:0;right:0;height:1px;background:linear-gradient(90deg,transparent,#dabe64,transparent)}.messages-container[_ngcontent-%COMP%]{flex:1;padding:24px;overflow-y:auto;display:flex;flex-direction:column;gap:16px;scroll-behavior:smooth}.messages-container[_ngcontent-%COMP%]::-webkit-scrollbar{width:6px}.messages-container[_ngcontent-%COMP%]::-webkit-scrollbar-track{background:#0000001a;border-radius:3px}.messages-container[_ngcontent-%COMP%]::-webkit-scrollbar-thumb{background:linear-gradient(to bottom,#746535,#dabe64);border-radius:3px}.messages-container[_ngcontent-%COMP%]::-webkit-scrollbar-thumb:hover{background:linear-gradient(to bottom,#dabe64,#746535)}.welcome-message[_ngcontent-%COMP%]{text-align:center;padding:32px 20px;background:linear-gradient(135deg,#dabe641a,#7465351a);border:1px solid rgba(218,190,100,.3);border-radius:16px;margin-bottom:16px;-webkit-backdrop-filter:blur(10px);backdrop-filter:blur(10px)}.welcome-icon[_ngcontent-%COMP%]{margin-bottom:16px}.welcome-icon[_ngcontent-%COMP%]   i[_ngcontent-%COMP%]{font-size:2.5rem;color:#dabe64;filter:drop-shadow(0 0 10px rgba(218,190,100,.5))}.welcome-message[_ngcontent-%COMP%]   h3[_ngcontent-%COMP%]{color:#dabe64;margin:0 0 8px;font-size:1.5rem;font-weight:600}.welcome-message[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{color:#dabe64cc;margin:0;font-size:1rem}.message-wrapper[_ngcontent-%COMP%]{display:flex;animation:_ngcontent-%COMP%_slideIn .4s ease-out}.user-wrapper[_ngcontent-%COMP%]{justify-content:flex-end}.bot-wrapper[_ngcontent-%COMP%]{justify-content:flex-start}.message[_ngcontent-%COMP%]{max-width:75%;padding:16px 20px;border-radius:20px;position:relative;-webkit-backdrop-filter:blur(10px);backdrop-filter:blur(10px);transition:all .3s ease}.message[_ngcontent-%COMP%]:hover{transform:translateY(-2px);box-shadow:0 8px 20px #0000004d}.bot-message[_ngcontent-%COMP%]{background:linear-gradient(135deg,#1119,#1e1e1e99);color:#dabe64;border:1px solid rgba(218,190,100,.3);border-bottom-left-radius:6px;position:relative}.bot-message[_ngcontent-%COMP%]:before{content:"";position:absolute;left:-8px;bottom:0;width:0;height:0;border-style:solid;border-width:0 8px 12px 0;border-color:transparent rgba(218,190,100,.3) transparent transparent}.user-message[_ngcontent-%COMP%]{background:linear-gradient(135deg,#dabe6426,#74653526);color:#dabe64;border:1px solid rgba(218,190,100,.4);border-bottom-right-radius:6px;position:relative}.user-message[_ngcontent-%COMP%]:before{content:"";position:absolute;right:-8px;bottom:0;width:0;height:0;border-style:solid;border-width:0 0 12px 8px;border-color:transparent transparent rgba(218,190,100,.4) transparent}.message-content[_ngcontent-%COMP%]{display:flex;flex-direction:column}.message-text[_ngcontent-%COMP%]{line-height:1.5;word-wrap:break-word}.message-time[_ngcontent-%COMP%]{font-size:.7rem;opacity:.6;margin-top:8px;align-self:flex-end;color:#dabe64b3}.loading-wrapper[_ngcontent-%COMP%]{display:flex;justify-content:flex-start;animation:_ngcontent-%COMP%_slideIn .4s ease-out}.loading-message[_ngcontent-%COMP%]{display:flex;align-items:center;gap:12px;padding:16px 20px;background:linear-gradient(135deg,#1119,#1e1e1e99);border:1px solid rgba(218,190,100,.3);border-radius:20px 20px 20px 6px;-webkit-backdrop-filter:blur(10px);backdrop-filter:blur(10px)}.typing-indicator[_ngcontent-%COMP%]{display:flex;gap:4px}.typing-indicator[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{width:8px;height:8px;background:linear-gradient(45deg,#746535,#dabe64);border-radius:50%;animation:_ngcontent-%COMP%_typing 1.4s infinite ease-in-out}.typing-indicator[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]:nth-child(2){animation-delay:.2s}.typing-indicator[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]:nth-child(3){animation-delay:.4s}.typing-text[_ngcontent-%COMP%]{color:#dabe64cc;font-size:.9rem;font-style:italic}.input-container[_ngcontent-%COMP%]{padding:20px;background:linear-gradient(135deg,#0000004d,#1a1f2e4d);border-top:1px solid rgba(218,190,100,.2);-webkit-backdrop-filter:blur(10px);backdrop-filter:blur(10px)}.input-wrapper[_ngcontent-%COMP%]{display:flex;gap:12px;align-items:center}.message-input[_ngcontent-%COMP%]{flex:1;padding:14px 20px;border:2px solid rgba(218,190,100,.3);border-radius:25px;outline:none;font-size:15px;background:#0000004d;color:#dabe64;transition:all .3s ease;-webkit-backdrop-filter:blur(10px);backdrop-filter:blur(10px)}.message-input[_ngcontent-%COMP%]::placeholder{color:#dabe6480}.message-input[_ngcontent-%COMP%]:focus{border-color:#dabe64;box-shadow:0 0 0 3px #dabe6433;background:#0006}.send-button[_ngcontent-%COMP%]{width:52px;height:52px;border-radius:50%;background:linear-gradient(135deg,#746535,#dabe64);color:#fff;border:none;display:flex;align-items:center;justify-content:center;transition:all .3s ease;cursor:pointer;position:relative;overflow:hidden}.send-button[_ngcontent-%COMP%]:before{content:"";position:absolute;inset:0;background:linear-gradient(135deg,#dabe64,#746535);opacity:0;transition:opacity .3s ease}.send-button[_ngcontent-%COMP%]:hover:not(:disabled):before{opacity:1}.send-button[_ngcontent-%COMP%]:hover:not(:disabled){transform:translateY(-2px);box-shadow:0 8px 20px #dabe644d}.send-button[_ngcontent-%COMP%]:disabled{opacity:.5;cursor:not-allowed;transform:none}.send-icon[_ngcontent-%COMP%], .loading-spinner[_ngcontent-%COMP%]{position:relative;z-index:2;font-size:1.1rem}.send-button.loading[_ngcontent-%COMP%]{animation:_ngcontent-%COMP%_pulse 1s infinite}@keyframes _ngcontent-%COMP%_slideIn{0%{opacity:0;transform:translateY(15px)}to{opacity:1;transform:translateY(0)}}@keyframes _ngcontent-%COMP%_typing{0%,60%,to{transform:translateY(0);opacity:.5}30%{transform:translateY(-8px);opacity:1}}@keyframes _ngcontent-%COMP%_pulse{0%,to{transform:scale(1)}50%{transform:scale(1.05)}}@media (max-width: 768px){.chatbot-container[_ngcontent-%COMP%]{border-radius:12px}.messages-container[_ngcontent-%COMP%]{padding:16px}.message[_ngcontent-%COMP%]{max-width:85%;padding:12px 16px}.input-container[_ngcontent-%COMP%]{padding:16px}.message-input[_ngcontent-%COMP%]{padding:12px 16px;font-size:14px}.send-button[_ngcontent-%COMP%]{width:46px;height:46px}}']})};var w=class e{title="terra-web";constructor(){}static \u0275fac=function(n){return new(n||e)};static \u0275cmp=y({type:e,selectors:[["app-root"]],decls:11,vars:0,consts:[["type","button","data-bs-toggle","offcanvas","data-bs-target","#offCanvasChat","aria-controls","offCanvasChat",1,"button-assistant"],[1,"fa-solid","fa-robot",2,"pointer-events","none"],["tabindex","-1","id","offCanvasChat","aria-labelledby","offCanvasChatLabel",1,"offcanvas","offcanvas-end","chatbot-container"],[1,"offcanvas-header"],["id","offCanvasChatLabel",1,"offcanvas-title"],[1,"fa-solid","fa-robot"],["type","button","data-bs-dismiss","offcanvas","aria-label","Cerrar",1,"btn-close","text-reset"],[1,"offcanvas-body","p-0"]],template:function(n,o){n&1&&(d(0,"router-outlet"),r(1,"button",0),d(2,"i",1),i(),r(3,"div",2)(4,"div",3)(5,"h5",4),d(6,"i",5),g(7," Terra Assistant"),i(),d(8,"button",6),i(),r(9,"div",7),d(10,"app-botterra"),i()())},dependencies:[me,M],styles:[".button-assistant[_ngcontent-%COMP%]{position:fixed;bottom:10%;right:50px;z-index:999;width:60px;height:60px;padding:10px;font-size:24px;background:linear-gradient(to right,#746535,#dabe64);color:#fff;border:none;border-radius:50%;box-shadow:0 2px 8px #0000004d;display:flex;align-items:center;justify-content:center;transition:transform .2s ease}.button-assistant[_ngcontent-%COMP%]:hover{transform:scale(1.05);padding:15px}.chatbot-container[_ngcontent-%COMP%]{background:linear-gradient(to bottom,#0c0f20,#000)}.offcanvas-title[_ngcontent-%COMP%]{color:#dabe64}"]})};ie(w,Me).catch(e=>console.error(e));
