import{b as T,c as x,d as F,e as V,h as I,j as L,k as G,r as R,t as N}from"./chunk-4IBMTDLT.js";import{b as w,c as k,d as y,f as P,g as O,i as E,o as M,s as S}from"./chunk-R5WGTBAP.js";import{Aa as v,Ba as _,Ga as h,La as g,Sa as c,Xa as n,Ya as o,Z as f,Za as l,_ as u,ab as b,db as p,eb as m,gb as d,ib as C,wa as s}from"./chunk-LPC6BBNP.js";function z(i,r){i&1&&(n(0,"span"),d(1," Email is required "),o())}function q(i,r){i&1&&(n(0,"span"),d(1," Please enter a valid email "),o())}function j(i,r){if(i&1&&(n(0,"div",26),g(1,z,2,0,"span",27)(2,q,2,0,"span",27),o()),i&2){let e,t,a=m(2);s(),c("ngIf",(e=a.emailForm.get("email"))==null||e.errors==null?null:e.errors.required),s(),c("ngIf",(t=a.emailForm.get("email"))==null||t.errors==null?null:t.errors.email)}}function B(i,r){if(i&1){let e=b();n(0,"div",11)(1,"form",12),p("ngSubmit",function(){f(e);let a=m();return u(a.goToNextStep())}),n(2,"div",13)(3,"label",14),l(4,"i",15),d(5," Email address "),o(),l(6,"input",16),g(7,j,3,2,"div",17),o(),n(8,"button",18),d(9," Next "),l(10,"i",19),o()(),n(11,"div",20)(12,"p",21)(13,"span"),d(14,"Or continue with"),o()(),n(15,"div",22)(16,"button",23),p("click",function(){f(e);let a=m();return u(a.loginWithGoogle())}),l(17,"i",24),d(18," Google "),o(),n(19,"button",23),p("click",function(){f(e);let a=m();return u(a.loginWithFacebook())}),l(20,"i",25),d(21," Facebook "),o()()()()}if(i&2){let e,t=m();s(),c("formGroup",t.emailForm),s(6),c("ngIf",((e=t.emailForm.get("email"))==null?null:e.invalid)&&((e=t.emailForm.get("email"))==null?null:e.touched)),s(),c("disabled",t.emailForm.invalid)}}function D(i,r){i&1&&(n(0,"span"),d(1," Password is required "),o())}function Y(i,r){if(i&1&&(n(0,"div",26),g(1,D,2,0,"span",27),o()),i&2){let e,t=m(2);s(),c("ngIf",(e=t.passwordForm.get("password"))==null||e.errors==null?null:e.errors.required)}}function W(i,r){if(i&1&&(n(0,"li"),l(1,"i",43),d(2),o()),i&2){let e=r.$implicit;s(2),C(" ",e," ")}}function H(i,r){if(i&1&&(n(0,"div",40)(1,"ul",41),g(2,W,3,1,"li",42),o()()),i&2){let e=m(2);s(2),c("ngForOf",e.errors)}}function U(i,r){if(i&1){let e=b();n(0,"button",44),p("click",function(){f(e);let a=m(2);return u(a.navigateToResendEmailVerification())}),l(1,"i",37),d(2," Go to Resend Email Verification "),o()}}function $(i,r){if(i&1){let e=b();n(0,"div",11)(1,"form",12),p("ngSubmit",function(){f(e);let a=m();return u(a.login())}),n(2,"div",13)(3,"label",28),l(4,"i",29),d(5," Password "),o(),n(6,"div",30),l(7,"input",31),n(8,"button",32),p("click",function(){f(e);let a=m();return u(a.togglePasswordVisibility())}),l(9,"i",33),o()(),g(10,Y,2,1,"div",17),o(),g(11,H,3,1,"div",34),n(12,"button",18),d(13," Login "),l(14,"i",35),o(),l(15,"hr"),n(16,"button",36),p("click",function(){f(e);let a=m();return u(a.goToBack())}),l(17,"i",37),d(18," Back"),o(),l(19,"br")(20,"br")(21,"div",38),g(22,U,3,0,"button",39),o()()}if(i&2){let e,t=m();s(),c("formGroup",t.passwordForm),s(6),c("type",t.passwordVisible?"text":"password"),s(2),c("ngClass",t.passwordVisible?"fa-eye-slash":"fa-eye"),s(),c("ngIf",((e=t.passwordForm.get("password"))==null?null:e.invalid)&&((e=t.passwordForm.get("password"))==null?null:e.touched)),s(),c("ngIf",t.errors.length>0),s(),c("disabled",t.passwordForm.invalid),s(10),c("ngIf",t.btnGoToResendEmailVerification)}}var A=class i{constructor(r,e,t,a,J){this.fb=r;this.router=e;this.http=t;this.authService=a;this.renderer=J;this.emailForm=this.fb.group({email:["",[x.required,x.email]]}),this.passwordForm=this.fb.group({password:["",[x.required]]})}emailForm;passwordForm;errors=[];currentStep=1;btnGoToResendEmailVerification=!1;userEmail="";passwordVisible=!1;ngOnInit(){let r=document.querySelector(".auth-container"),e=localStorage.getItem("theme");r&&(e==="dark"?this.renderer.addClass(r,"dark-mode"):this.renderer.removeClass(r,"dark-mode"))}goToNextStep(){this.emailForm.valid?(this.userEmail=this.emailForm.get("email")?.value,this.currentStep=2,console.log("Email validated:",this.userEmail)):this.emailForm.markAllAsTouched()}getEmail(){return this.emailForm.get("email")?.value}goToBack(){this.currentStep=1}login(){if(this.errors=[],this.btnGoToResendEmailVerification=!1,this.passwordForm.valid&&this.userEmail){let r={email:this.userEmail,password:this.passwordForm.get("password")?.value};console.log("Datos de login:",r),this.authService.login(r).subscribe({next:e=>{this.btnGoToResendEmailVerification=!1,this.authService.setEmail(this.userEmail),this.router.navigate(["/dashboard"])},error:e=>{e.error?.error==="EMAIL_NOT_VERIFIED"?(this.btnGoToResendEmailVerification=!0,this.errors.push("Your email is not verified. Please verify it or resend verification email.")):(this.btnGoToResendEmailVerification=!1,this.errors.push(e.error?.message||"Login failed"))}})}else this.btnGoToResendEmailVerification=!1,this.userEmail||alert("Email is required"),this.passwordForm.markAllAsTouched()}navigateToResendEmailVerification(){this.router.navigate(["/resend-email-verification"],{queryParams:{email:this.userEmail}})}loginWithGoogle(){console.log("Google login clicked"),alert("Google login clicked (This is a stub - no actual authentication)")}loginWithFacebook(){console.log("Facebook login clicked"),alert("Facebook login clicked (This is a stub - no actual authentication)")}navigateToForgotPassword(){this.router.navigate(["/forgot-password"])}navigateToRegister(){console.log("Navigate to register"),this.router.navigate(["/register"])}togglePasswordVisibility(){this.passwordVisible=!this.passwordVisible}static \u0275fac=function(e){return new(e||i)(_(R),_(M),_(E),_(S),_(v))};static \u0275cmp=h({type:i,selectors:[["app-login"]],decls:17,vars:2,consts:[[1,"auth-container"],[2,"position","relative","width","300px","height","227px"],["ngSrc","assets/images/lineage2Terra_blanco.webp","fill","","alt","Logo de Terra","priority","",1,"logoTerra"],[1,"auth-card"],[1,"auth-title"],[1,"fa-solid","fa-user"],["class","form-step",4,"ngIf"],[1,"auth-links"],[1,"auth-link",3,"click"],[1,"fas","fa-question-circle"],[1,"fas","fa-user-plus"],[1,"form-step"],[3,"ngSubmit","formGroup"],[1,"form-group"],["for","email"],[1,"fas","fa-envelope"],["type","email","id","email","formControlName","email","placeholder"," Enter your email",1,"form-control"],["class","error-message",4,"ngIf"],["type","submit",1,"btn-primary",3,"disabled"],[1,"fas","fa-arrow-right"],[1,"social-login"],[1,"divider"],[1,"social-buttons"],["type","button",1,"btn-social",3,"click"],[1,"fab","fa-google","social-icon"],[1,"fab","fa-facebook-f","social-icon"],[1,"error-message"],[4,"ngIf"],["for","password"],[1,"fas","fa-lock"],[1,"password-input-container"],["id","password","formControlName","password","placeholder","Enter your password",1,"form-control",3,"type"],["type","button",1,"password-toggle",3,"click"],[1,"fas",3,"ngClass"],["class","alert alert-danger","role","alert",4,"ngIf"],[1,"fas","fa-sign-in-alt"],[1,"btn-secondary",3,"click"],[1,"fas","fa-arrow-left"],["data-sitekey","0x4AAAAAABhBLTkGwYdbEAbo",1,"cf-turnstile"],["ngClass","btn-secondary",3,"click",4,"ngIf"],["role","alert",1,"alert","alert-danger"],[1,"mb-0",2,"list-style","none","padding","0px"],[4,"ngFor","ngForOf"],[1,"fa-solid","fa-triangle-exclamation","text-danger"],["ngClass","btn-secondary",3,"click"]],template:function(e,t){e&1&&(n(0,"div",0)(1,"div")(2,"div",1),l(3,"img",2),o()(),n(4,"div",3)(5,"h2",4),l(6,"i",5),d(7," Login to your account "),o(),g(8,B,22,3,"div",6)(9,$,23,7,"div",6),n(10,"div",7)(11,"a",8),p("click",function(){return t.navigateToForgotPassword()}),l(12,"i",9),d(13," Forgot password? "),o(),n(14,"a",8),p("click",function(){return t.navigateToRegister()}),l(15,"i",10),d(16," Create an account "),o()()()()),e&2&&(s(8),c("ngIf",t.currentStep===1),s(),c("ngIf",t.currentStep===2))},dependencies:[P,w,k,y,N,I,T,F,V,L,G,O],styles:['.auth-container[_ngcontent-%COMP%]{display:flex;flex-direction:column;justify-content:center;align-items:center;min-height:100vh;padding:20px;background:linear-gradient(to bottom,#0c0f20,#000);font-family:Segoe UI,Tahoma,Geneva,Verdana,sans-serif;box-sizing:border-box}.auth-card[_ngcontent-%COMP%]{background-color:#11111165;border-radius:12px;padding:30px;width:100%;max-width:400px;border:1px solid #3b3b3b}.auth-title[_ngcontent-%COMP%]{color:#f9f9f9;text-align:center;margin-bottom:30px;font-weight:600;font-size:24px}.form-group[_ngcontent-%COMP%]{margin-bottom:20px}label[_ngcontent-%COMP%]{display:block;margin-bottom:8px;color:#e0e0e0;font-size:14px}.form-control[_ngcontent-%COMP%]{width:100%;border-radius:8px;height:50px;border:1px solid rgba(255,255,255,.2);background-color:#ffffff12;color:#fff;font-size:16px;transition:all .3s ease}.form-control[_ngcontent-%COMP%]:focus{outline:none;border-color:#dabe64;box-shadow:0 0 0 2px #dabe6440}.form-control[_ngcontent-%COMP%]::placeholder{color:#fff6}.btn-primary[_ngcontent-%COMP%]{width:100%;padding:12px;border:none;border-radius:8px;background:linear-gradient(to right,#746535,#dabe64);color:#0c0f20;font-weight:600;font-size:16px;cursor:pointer;transition:all .3s ease}.btn-primary[_ngcontent-%COMP%]:hover{transform:translateY(-2px);box-shadow:0 4px 12px #dabe644d}.btn-primary[_ngcontent-%COMP%]:disabled{opacity:.6;cursor:not-allowed;transform:none;box-shadow:none}.btn-secondary[_ngcontent-%COMP%]{width:100%;padding:12px;border:1px solid rgba(218,190,100,.5);border-radius:8px;background:transparent;color:#dabe64;font-weight:600;font-size:16px;cursor:pointer;transition:all .3s ease}.btn-secondary[_ngcontent-%COMP%]:hover{background-color:#dabe641a}.social-login[_ngcontent-%COMP%]{margin-top:24px}.divider[_ngcontent-%COMP%]{display:flex;align-items:center;text-align:center;color:#ffffff80;font-size:14px;margin:20px 0}.divider[_ngcontent-%COMP%]:before, .divider[_ngcontent-%COMP%]:after{content:"";flex:1;border-bottom:1px solid rgba(255,255,255,.2)}.divider[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{padding:0 10px}.social-buttons[_ngcontent-%COMP%]{display:flex;gap:12px}.btn-social[_ngcontent-%COMP%]{flex:1;padding:10px;border:1px solid rgba(255,255,255,.2);border-radius:8px;background-color:#ffffff12;color:#fff;font-size:14px;cursor:pointer;transition:all .3s ease;display:flex;align-items:center;justify-content:center}.btn-social[_ngcontent-%COMP%]:hover{background-color:#ffffff1f}.social-icon[_ngcontent-%COMP%]{margin-right:8px}.auth-links[_ngcontent-%COMP%]{display:flex;justify-content:space-between;margin-top:24px}.auth-link[_ngcontent-%COMP%]{color:#dabe64;text-decoration:none;font-size:14px;cursor:pointer;transition:all .3s ease}.auth-link[_ngcontent-%COMP%]:hover{text-decoration:underline}.error-message[_ngcontent-%COMP%]{color:#ff6b6b;font-size:12px;margin-top:5px}.form-step[_ngcontent-%COMP%]{animation:_ngcontent-%COMP%_fadeIn .3s ease-in-out}@keyframes _ngcontent-%COMP%_fadeIn{0%{opacity:0;transform:translateY(10px)}to{opacity:1;transform:translateY(0)}}@media (max-width: 480px){.auth-card[_ngcontent-%COMP%]{padding:20px}.btn-primary[_ngcontent-%COMP%], .btn-secondary[_ngcontent-%COMP%], .form-control[_ngcontent-%COMP%]{padding:10px}.social-buttons[_ngcontent-%COMP%]{flex-direction:column}.auth-links[_ngcontent-%COMP%]{flex-direction:column;align-items:center;gap:10px}}.auth-container.dark-mode[_ngcontent-%COMP%]{background:linear-gradient(to bottom,#121212,#000);color:#ddd}.auth-container.dark-mode[_ngcontent-%COMP%]   .auth-card[_ngcontent-%COMP%]{background-color:#1e1e1eb3;border-color:#555}.auth-container.dark-mode[_ngcontent-%COMP%]   .form-control[_ngcontent-%COMP%]{background-color:#3232324d;color:#eee;border-color:#666}.auth-container.dark-mode[_ngcontent-%COMP%]   label[_ngcontent-%COMP%], .auth-container.dark-mode[_ngcontent-%COMP%]   .auth-title[_ngcontent-%COMP%]{color:#ccc}.password-input-container[_ngcontent-%COMP%]{position:relative}.password-toggle[_ngcontent-%COMP%]{position:absolute;right:10px;top:50%;transform:translateY(-50%);background:transparent;border:none;color:#fff9;cursor:pointer;padding:5px}.password-toggle[_ngcontent-%COMP%]:hover{color:#dabe64}']})};export{A as LoginComponent};
