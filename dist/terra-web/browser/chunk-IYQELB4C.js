import{a as q}from"./chunk-GZNOSLHB.js";import{b as V,c as h,d as I,e as L,h as G,j as A,k as R,r as N,t as z}from"./chunk-KMFUUNB7.js";import{b as k,c as P,d as M,f as O,g as E,i as S,o as T,s as F}from"./chunk-4QVFRYOO.js";import{$ as f,$a as l,Ca as C,Da as _,Ia as w,Na as g,Ua as c,V as v,Za as o,_a as r,aa as u,cb as b,d as x,fb as p,gb as m,ib as d,kb as y,ya as s}from"./chunk-XCCBFHDG.js";function B(i,n){i&1&&(o(0,"span"),d(1," Email is required "),r())}function D(i,n){i&1&&(o(0,"span"),d(1," Please enter a valid email "),r())}function W(i,n){if(i&1&&(o(0,"div",27),g(1,B,2,0,"span",28)(2,D,2,0,"span",28),r()),i&2){let e,t,a=m(2);s(),c("ngIf",(e=a.emailForm.get("email"))==null||e.errors==null?null:e.errors.required),s(),c("ngIf",(t=a.emailForm.get("email"))==null||t.errors==null?null:t.errors.email)}}function Y(i,n){if(i&1){let e=b();o(0,"div",11)(1,"form",12),p("ngSubmit",function(){f(e);let a=m();return u(a.goToNextStep())}),o(2,"div",13)(3,"label",14),l(4,"i",15),d(5," Email address "),r(),l(6,"input",16),g(7,W,3,2,"div",17),r(),o(8,"button",18),d(9," Next "),l(10,"i",19),r()(),o(11,"div",20)(12,"p",21)(13,"span"),d(14,"Or continue with"),r()(),o(15,"div",22)(16,"button",23),p("click",function(){f(e);let a=m();return u(a.loginWithGoogle())}),l(17,"i",24),d(18," \xA0 Google "),r(),o(19,"button",25),p("click",function(){f(e);let a=m();return u(a.loginWithFacebook())}),l(20,"i",26),d(21," \xA0Facebook "),r()()()()}if(i&2){let e,t=m();s(),c("formGroup",t.emailForm),s(6),c("ngIf",((e=t.emailForm.get("email"))==null?null:e.invalid)&&((e=t.emailForm.get("email"))==null?null:e.touched)),s(),c("disabled",t.emailForm.invalid)}}function H(i,n){i&1&&(o(0,"span"),d(1," Password is required "),r())}function U(i,n){if(i&1&&(o(0,"div",27),g(1,H,2,0,"span",28),r()),i&2){let e,t=m(2);s(),c("ngIf",(e=t.passwordForm.get("password"))==null||e.errors==null?null:e.errors.required)}}function $(i,n){if(i&1&&(o(0,"li"),l(1,"i",44),d(2),r()),i&2){let e=n.$implicit;s(2),y(" ",e," ")}}function J(i,n){if(i&1&&(o(0,"div",41)(1,"ul",42),g(2,$,3,1,"li",43),r()()),i&2){let e=m(2);s(2),c("ngForOf",e.errors)}}function K(i,n){if(i&1){let e=b();o(0,"button",45),p("click",function(){f(e);let a=m(2);return u(a.navigateToResendEmailVerification())}),l(1,"i",38),d(2," Go to Resend Email Verification "),r()}}function Q(i,n){if(i&1){let e=b();o(0,"div",11)(1,"form",12),p("ngSubmit",function(){f(e);let a=m();return u(a.login())}),o(2,"div",13)(3,"label",29),l(4,"i",30),d(5," Password "),r(),o(6,"div",31),l(7,"input",32),o(8,"button",33),p("click",function(){f(e);let a=m();return u(a.togglePasswordVisibility())}),l(9,"i",34),r()(),g(10,U,2,1,"div",17),r(),g(11,J,3,1,"div",35),o(12,"button",18),d(13," Login "),l(14,"i",36),r(),l(15,"hr"),o(16,"button",37),p("click",function(){f(e);let a=m();return u(a.goToBack())}),l(17,"i",38),d(18," Back"),r(),l(19,"br")(20,"br")(21,"div",39),g(22,K,3,0,"button",40),r()()}if(i&2){let e,t=m();s(),c("formGroup",t.passwordForm),s(6),c("type",t.passwordVisible?"text":"password"),s(2),c("ngClass",t.passwordVisible?"fa-eye-slash":"fa-eye"),s(),c("ngIf",((e=t.passwordForm.get("password"))==null?null:e.invalid)&&((e=t.passwordForm.get("password"))==null?null:e.touched)),s(),c("ngIf",t.errors.length>0),s(),c("disabled",t.passwordForm.invalid),s(10),c("ngIf",t.btnGoToResendEmailVerification)}}var j=class i{constructor(n,e,t,a,X){this.fb=n;this.router=e;this.http=t;this.authService=a;this.renderer=X;this.emailForm=this.fb.group({email:["",[h.required,h.email]]}),this.passwordForm=this.fb.group({password:["",[h.required]]})}emailForm;passwordForm;errors=[];currentStep=1;btnGoToResendEmailVerification=!1;userEmail="";passwordVisible=!1;googleAuth=v(q);isLoading=!1;errorMessage="";ngOnInit(){let n=document.querySelector(".auth-container"),e=localStorage.getItem("theme");n&&(e==="dark"?this.renderer.addClass(n,"dark-mode"):this.renderer.removeClass(n,"dark-mode"))}goToNextStep(){this.emailForm.valid?(this.userEmail=this.emailForm.get("email")?.value,this.currentStep=2):this.emailForm.markAllAsTouched()}getEmail(){return this.emailForm.get("email")?.value}goToBack(){this.currentStep=1}login(){if(this.errors=[],this.btnGoToResendEmailVerification=!1,this.passwordForm.valid&&this.userEmail){let n={email:this.userEmail,password:this.passwordForm.get("password")?.value};this.authService.login(n).subscribe({next:e=>{this.btnGoToResendEmailVerification=!1,this.authService.setEmail(this.userEmail),this.router.navigate(["/dashboard"])},error:e=>{e.error?.error==="EMAIL_NOT_VERIFIED"?(this.btnGoToResendEmailVerification=!0,this.errors.push("Your email is not verified. Please verify it or resend verification email.")):(this.btnGoToResendEmailVerification=!1,this.errors.push(e.error?.message||"Login failed"))}})}else this.btnGoToResendEmailVerification=!1,this.userEmail||alert("Email is required"),this.passwordForm.markAllAsTouched()}navigateToResendEmailVerification(){this.router.navigate(["/resend-email-verification"],{queryParams:{email:this.userEmail}})}loginWithGoogle(){return x(this,null,function*(){this.isLoading=!0,this.errorMessage="";try{console.log("Iniciando autenticaci\xF3n con Google...");let n=yield this.googleAuth.signInWithGoogle();console.log("Usuario:",n),console.log("Token almacenado:",localStorage.getItem("google_token")),this.router.navigate(["/dashboard"])}catch(n){this.errorMessage="Error al iniciar sesi\xF3n con Google",console.error("Error completo:",n)}finally{this.isLoading=!1}})}loginWithFacebook(){return x(this,null,function*(){this.isLoading=!0,this.errorMessage="";try{console.log("Iniciando autenticaci\xF3n con Facebook...");let n=yield this.googleAuth.signInWithFacebook();console.log("Usuario:",n),this.router.navigate(["/dashboard"])}catch(n){this.errorMessage="Error al iniciar sesi\xF3n con Facebook",console.error("Error completo:",n)}finally{this.isLoading=!1}})}navigateToForgotPassword(){this.router.navigate(["/forgot-password"])}navigateToRegister(){this.router.navigate(["/register"])}togglePasswordVisibility(){this.passwordVisible=!this.passwordVisible}static \u0275fac=function(e){return new(e||i)(_(N),_(T),_(S),_(F),_(C))};static \u0275cmp=w({type:i,selectors:[["app-login"]],decls:17,vars:2,consts:[[1,"auth-container"],[2,"position","relative","width","300px","height","227px"],["ngSrc","assets/images/lineage2Terra_blanco.webp","fill","","alt","Logo de Terra","priority","",1,"logoTerra"],[1,"auth-card"],[1,"auth-title"],[1,"fa-solid","fa-user"],["class","form-step",4,"ngIf"],[1,"auth-links"],[1,"auth-link",3,"click"],[1,"fas","fa-question-circle"],[1,"fas","fa-user-plus"],[1,"form-step"],[3,"ngSubmit","formGroup"],[1,"form-group"],["for","email"],[1,"fas","fa-envelope"],["type","email","id","email","formControlName","email","placeholder"," Enter your email",1,"form-control"],["class","error-message",4,"ngIf"],["type","submit",1,"btn-primary",3,"disabled"],[1,"fas","fa-arrow-right"],[1,"social-login"],[1,"divider"],[1,"social-buttons"],["type","button",1,"btn-social","google",3,"click"],[1,"fab","fa-google","social-icon"],["type","button",1,"btn-social","facebook",3,"click"],[1,"fab","fa-facebook-f","social-icon"],[1,"error-message"],[4,"ngIf"],["for","password"],[1,"fas","fa-lock"],[1,"password-input-container"],["id","password","formControlName","password","placeholder","Enter your password",1,"form-control",3,"type"],["type","button",1,"password-toggle",3,"click"],[1,"fas",3,"ngClass"],["class","alert alert-danger","role","alert",4,"ngIf"],[1,"fas","fa-sign-in-alt"],[1,"btn-secondary",3,"click"],[1,"fas","fa-arrow-left"],["data-sitekey","0x4AAAAAABhBLTkGwYdbEAbo",1,"cf-turnstile"],["ngClass","btn-secondary",3,"click",4,"ngIf"],["role","alert",1,"alert","alert-danger"],[1,"mb-0",2,"list-style","none","padding","0px"],[4,"ngFor","ngForOf"],[1,"fa-solid","fa-triangle-exclamation","text-danger"],["ngClass","btn-secondary",3,"click"]],template:function(e,t){e&1&&(o(0,"div",0)(1,"div")(2,"div",1),l(3,"img",2),r()(),o(4,"div",3)(5,"h2",4),l(6,"i",5),d(7," Login to your account "),r(),g(8,Y,22,3,"div",6)(9,Q,23,7,"div",6),o(10,"div",7)(11,"a",8),p("click",function(){return t.navigateToForgotPassword()}),l(12,"i",9),d(13," Forgot password? "),r(),o(14,"a",8),p("click",function(){return t.navigateToRegister()}),l(15,"i",10),d(16," Create an account "),r()()()()),e&2&&(s(8),c("ngIf",t.currentStep===1),s(),c("ngIf",t.currentStep===2))},dependencies:[O,k,P,M,z,G,V,I,L,A,R,E],styles:['.auth-container[_ngcontent-%COMP%]{display:flex;flex-direction:column;justify-content:center;align-items:center;min-height:100vh;padding:20px;background:linear-gradient(to bottom,#0c0f20,#000);font-family:Segoe UI,Tahoma,Geneva,Verdana,sans-serif;box-sizing:border-box}.auth-card[_ngcontent-%COMP%]{background-color:#11111165;border-radius:12px;padding:30px;width:100%;max-width:400px;border:1px solid #3b3b3b}.auth-title[_ngcontent-%COMP%]{color:#f9f9f9;text-align:center;margin-bottom:30px;font-weight:600;font-size:24px}.form-group[_ngcontent-%COMP%]{margin-bottom:20px}label[_ngcontent-%COMP%]{display:block;margin-bottom:8px;color:#e0e0e0;font-size:14px}.form-control[_ngcontent-%COMP%]{width:100%;border-radius:8px;height:50px;border:1px solid rgba(255,255,255,.2);background-color:#ffffff12;color:#fff;font-size:16px;transition:all .3s ease}.form-control[_ngcontent-%COMP%]:focus{outline:none;border-color:#dabe64;box-shadow:0 0 0 2px #dabe6440}.form-control[_ngcontent-%COMP%]::placeholder{color:#fff6}.btn-primary[_ngcontent-%COMP%]{width:100%;padding:12px;border:none;border-radius:8px;background:linear-gradient(to right,#746535,#dabe64);color:#0c0f20;font-weight:600;font-size:16px;cursor:pointer;transition:all .3s ease}.btn-primary[_ngcontent-%COMP%]:hover{transform:translateY(-2px);box-shadow:0 4px 12px #dabe644d}.btn-primary[_ngcontent-%COMP%]:disabled{opacity:.6;cursor:not-allowed;transform:none;box-shadow:none}.btn-secondary[_ngcontent-%COMP%]{width:100%;padding:12px;border:1px solid rgba(218,190,100,.5);border-radius:8px;background:transparent;color:#dabe64;font-weight:600;font-size:16px;cursor:pointer;transition:all .3s ease}.btn-secondary[_ngcontent-%COMP%]:hover{background-color:#dabe641a}.social-login[_ngcontent-%COMP%]{margin-top:24px}.divider[_ngcontent-%COMP%]{display:flex;align-items:center;text-align:center;color:#ffffff80;font-size:14px;margin:20px 0}.divider[_ngcontent-%COMP%]:before, .divider[_ngcontent-%COMP%]:after{content:"";flex:1;border-bottom:1px solid rgba(255,255,255,.2)}.divider[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{padding:0 10px}.social-buttons[_ngcontent-%COMP%]{display:flex;gap:12px}.btn-social[_ngcontent-%COMP%]{flex:1;padding:10px;border:1px solid rgba(255,255,255,.2);border-radius:8px;background-color:#ffffff12;color:#fff;font-size:14px;cursor:pointer;transition:all .3s ease;display:flex;align-items:center;justify-content:center}.btn-social[_ngcontent-%COMP%]:hover{background-color:#ffffff1f}.google[_ngcontent-%COMP%]{color:#db4437}.facebook[_ngcontent-%COMP%]{color:#4267b2}.auth-links[_ngcontent-%COMP%]{display:flex;justify-content:space-between;margin-top:24px}.auth-link[_ngcontent-%COMP%]{color:#dabe64;text-decoration:none;font-size:14px;cursor:pointer;transition:all .3s ease}.auth-link[_ngcontent-%COMP%]:hover{text-decoration:underline}.error-message[_ngcontent-%COMP%]{color:#ff6b6b;font-size:12px;margin-top:5px}.form-step[_ngcontent-%COMP%]{animation:_ngcontent-%COMP%_fadeIn .3s ease-in-out}@keyframes _ngcontent-%COMP%_fadeIn{0%{opacity:0;transform:translateY(10px)}to{opacity:1;transform:translateY(0)}}@media (max-width: 480px){.auth-card[_ngcontent-%COMP%]{padding:20px}.btn-primary[_ngcontent-%COMP%], .btn-secondary[_ngcontent-%COMP%], .form-control[_ngcontent-%COMP%]{padding:10px}.social-buttons[_ngcontent-%COMP%]{flex-direction:column}.auth-links[_ngcontent-%COMP%]{flex-direction:column;align-items:center;gap:10px}}.auth-container.dark-mode[_ngcontent-%COMP%]{background:linear-gradient(to bottom,#121212,#000);color:#ddd}.auth-container.dark-mode[_ngcontent-%COMP%]   .auth-card[_ngcontent-%COMP%]{background-color:#1e1e1eb3;border-color:#555}.auth-container.dark-mode[_ngcontent-%COMP%]   .form-control[_ngcontent-%COMP%]{background-color:#3232324d;color:#eee;border-color:#666}.auth-container.dark-mode[_ngcontent-%COMP%]   label[_ngcontent-%COMP%], .auth-container.dark-mode[_ngcontent-%COMP%]   .auth-title[_ngcontent-%COMP%]{color:#ccc}.password-input-container[_ngcontent-%COMP%]{position:relative}.password-toggle[_ngcontent-%COMP%]{position:absolute;right:10px;top:50%;transform:translateY(-50%);background:transparent;border:none;color:#fff9;cursor:pointer;padding:5px}.password-toggle[_ngcontent-%COMP%]:hover{color:#dabe64}']})};export{j as LoginComponent};
