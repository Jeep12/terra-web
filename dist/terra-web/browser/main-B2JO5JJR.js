import{b as ke,d as Me,g as Ie,u as De}from"./chunk-H3UTXL2W.js";import{a as xe}from"./chunk-474OEAUR.js";import{a as he,b as Ce,e as ye,f as _e,i as we,j}from"./chunk-S5WBJKBX.js";import{A as be,B as ve,C as O,j as ge,k as me,l as S,n as ce,p as P,x as X,y as ue,z as fe}from"./chunk-CSXME6MI.js";import{$a as Z,Bb as _,C as M,Cb as w,Db as x,Fb as m,Gb as ie,Hb as ne,Ja as $,Jb as oe,Ka as q,Kb as ae,Lb as se,O as U,Oa as R,Pa as W,Pb as Y,Qa as l,Qb as re,R as K,S as J,Sb as le,Vb as de,W as G,X as h,Xb as pe,_a as v,aa as Q,ba as f,ca as b,d as k,db as y,kb as ee,lb as d,nb as I,o as z,p as F,qb as a,rb as s,s as N,sb as p,t as V,vb as D,yb as C,zb as te}from"./chunk-HU55LA37.js";var Se=(t,e)=>{let i=h(xe),n=h(_e);return i.isLoggedIn().pipe(U(o=>{o||n.navigate(["/login"])}),V(o=>o),M(()=>(n.navigate(["/login"]),z(!1))))};var L=[{path:"",loadComponent:()=>import("./chunk-KVL7QRYU.js").then(t=>t.WebsiteComponent),children:[{path:"",redirectTo:"home",pathMatch:"full"},{path:"home",loadComponent:()=>import("./chunk-H2OXOMCG.js").then(t=>t.HomeComponent)},{path:"gallery",loadComponent:()=>import("./chunk-JW7LZMK7.js").then(t=>t.GalleryComponent)},{path:"downloads",loadComponent:()=>import("./chunk-Y6TACTF2.js").then(t=>t.DownloadComponent)}]},{path:"login",loadComponent:()=>import("./chunk-6JQCG62A.js").then(t=>t.LoginComponent)},{path:"register",loadComponent:()=>import("./chunk-PCTUXW6S.js").then(t=>t.RegisterComponent)},{path:"reset-password",loadComponent:()=>import("./chunk-WSCFYSMU.js").then(t=>t.ResetPasswordComponent)},{path:"forgot-password",loadComponent:()=>import("./chunk-EW5KINSS.js").then(t=>t.ForgotPasswordComponent)},{path:"resend-email-verification",loadComponent:()=>import("./chunk-MHEVAFU6.js").then(t=>t.ResendEmailVerificationComponent)},{path:"verify-email",loadComponent:()=>import("./chunk-OXAF7ODR.js").then(t=>t.VerifyEmailComponent)},{path:"two-factor-step",loadComponent:()=>import("./chunk-NY26VPF2.js").then(t=>t.TwoFactorComponent)},{path:"dashboard",loadComponent:()=>import("./chunk-EDCJBWEY.js").then(t=>t.Dashboard2Component),canActivate:[Se],children:[{path:"",pathMatch:"full",redirectTo:"home-dashboard"},{path:"home-dashboard",loadComponent:()=>import("./chunk-E4PDHU2U.js").then(t=>t.DashboardHomeComponent)},{path:"create-account-game",loadComponent:()=>import("./chunk-QTOJLCU7.js").then(t=>t.CreateAccountGameComponent)},{path:"change-password-game",loadComponent:()=>import("./chunk-7DQT6VLB.js").then(t=>t.ChangePasswordGameComponent)},{path:"buy-terra-coin",loadComponent:()=>import("./chunk-H23FFRBR.js").then(t=>t.BuyTerraCoinComponent)},{path:"send-terra-coin",loadComponent:()=>import("./chunk-K475RFWH.js").then(t=>t.SendTerraCoinComponent)},{path:"support",loadComponent:()=>import("./chunk-QTLLUL7O.js").then(t=>t.SupportComponent)},{path:"offline-market",loadComponent:()=>import("./chunk-5ZVI7CWC.js").then(t=>t.OfflineMarketComponent)},{path:"setting-account-master",loadComponent:()=>import("./chunk-4DW6YZTT.js").then(t=>t.SettingsAccountMasterComponent)}]},{path:"**",loadComponent:()=>import("./chunk-7RDI2YAC.js").then(t=>t.WebsiteNotFoundComponent)}],Pe=class t{static \u0275fac=function(i){return new(i||t)};static \u0275mod=Z({type:t});static \u0275inj=J({imports:[j.forRoot(L),j]})};var Oe=(t,e)=>{let i=localStorage.getItem("deviceId")||"",n=t.url.includes("n8n.l2terra.online"),o=t.url.includes("/api/auth/me"),r=n?t.headers:t.headers.set("X-Device-Id",i),g=t.clone({withCredentials:!n,headers:r});return e(g).pipe(M(c=>{if(o&&(c.status===401||c.status===403)){let u=new Error;return u.name="SilentAuthError",u.message=c.message,u.stack=c.stack,Object.defineProperty(u,"status",{value:c.status,writable:!1}),Object.defineProperty(u,"error",{value:c.error,writable:!1}),F(()=>u)}return F(()=>c)}))};var Te={providers:[de({eventCoalescing:!0}),we(L),fe(ve(),be([Oe]))]};var A=class t{constructor(e){this.http=e}WEBHOOK_URL=O.WEBHOOK_URL_N8N;AUTH_USERNAME=O.AUTH_USERNAME_N8N;AUTH_PASSWORD=O.AUTH_PASSWORD_N8N;sendMessageAsync(e){return k(this,null,function*(){let i={sessionId:"asdasdsa",message:e,timestamp:new Date().toISOString(),action:"sendMessage"},n=new X({"Content-Type":"application/json",Authorization:"Basic "+btoa(`${this.AUTH_USERNAME}:${this.AUTH_PASSWORD}`)});try{return yield N(this.http.post(this.WEBHOOK_URL,i,{headers:n,withCredentials:!1}))}catch(o){throw console.error("Error al enviar mensaje:",o),o}})}sendMessage(e){let i={sessionId:"asdasdsa",message:e,timestamp:new Date().toISOString(),action:"sendMessage"},n=new X({"Content-Type":"application/json",Authorization:"Basic "+btoa(`${this.AUTH_USERNAME}:${this.AUTH_PASSWORD}`)});return this.http.post(this.WEBHOOK_URL,i,{headers:n,withCredentials:!1})}static \u0275fac=function(i){return new(i||t)(G(ue))};static \u0275prov=K({token:t,factory:t.\u0275fac,providedIn:"root"})};var Be=["messagesContainer"],He=["messageInput"],Fe=(t,e)=>({"user-wrapper":t,"bot-wrapper":e}),Re=(t,e)=>({"user-message":t,"bot-message":e});function We(t,e){t&1&&(a(0,"div",13)(1,"h3"),m(2,"Hello! \u{1F44B}"),s(),a(3,"p"),m(4,"How can I help you today?"),s()())}function Ye(t,e){if(t&1&&(a(0,"div",14)(1,"div",15)(2,"div",16),p(3,"div",17),a(4,"div",18),m(5),re(6,"date"),s()()()()),t&2){let i=e.$implicit;d("ngClass",Y(7,Fe,i.sender==="user",i.sender==="bot")),l(),d("ngClass",Y(10,Re,i.sender==="user",i.sender==="bot")),l(2),d("innerHTML",i.text,$),l(2),ie(le(6,4,i.timestamp,"shortTime"))}}function Xe(t,e){t&1&&(a(0,"div",19)(1,"div",20)(2,"div",21),p(3,"span")(4,"span")(5,"span"),s(),a(6,"span",22),m(7,"Typing..."),s()()())}function je(t,e){t&1&&(a(0,"span",23),p(1,"i",24),s())}function Le(t,e){t&1&&(a(0,"span",25),p(1,"i",26),s())}var E=class t{messagesContainer;messageInput;msg="";messages=[];isLoading=!1;shouldScrollToBottom=!1;chatbotService=h(A);cdRef=h(pe);sanitizer=h(Ce);ngAfterViewChecked(){this.shouldScrollToBottom&&(this.scrollToBottom(),this.shouldScrollToBottom=!1)}sendMessage(){return k(this,null,function*(){let e=this.msg.trim();if(!(!e||this.isLoading)){this.addMessage(e,"user"),this.msg="",this.isLoading=!0,this.shouldScrollToBottom=!0,setTimeout(()=>{this.messageInput?.nativeElement?.focus()},100);try{let i=yield this.chatbotService.sendMessageAsync(e),n=this.extractBotResponse(i);this.addMessage(n,"bot")}catch(i){this.addMessage("Error al conectar con el servicio","bot"),console.error("Error:",i)}finally{this.isLoading=!1,this.shouldScrollToBottom=!0,this.forceViewUpdate()}}})}onKeyPress(e){e.key==="Enter"&&!e.shiftKey&&(e.preventDefault(),this.sendMessage())}addMessage(e,i){let n=i==="bot"?this.sanitizer.bypassSecurityTrustHtml(e.replace(/\n/g,"<br>")):e;this.messages=[...this.messages,{text:n,sender:i,timestamp:new Date}],this.shouldScrollToBottom=!0,this.cdRef.detectChanges()}extractBotResponse(e){return e?.output||e?.reply||e?.message||e?.data?.message||e?.result||JSON.stringify(e)||"Recib\xED tu mensaje"}forceViewUpdate(){this.cdRef.detectChanges()}scrollToBottom(){if(this.messagesContainer?.nativeElement){let e=this.messagesContainer.nativeElement;e.scrollTop=e.scrollHeight}}trackByMessage(e,i){return e}static \u0275fac=function(i){return new(i||t)};static \u0275cmp=v({type:t,selectors:[["app-botterra"]],viewQuery:function(i,n){if(i&1&&(_(Be,5),_(He,5)),i&2){let o;w(o=x())&&(n.messagesContainer=o.first),w(o=x())&&(n.messageInput=o.first)}},decls:13,vars:11,consts:[["messagesContainer",""],["messageInput",""],[1,"chatbot-container"],[1,"messages-container"],["class","welcome-message",4,"ngIf"],["class","message-wrapper",3,"ngClass",4,"ngFor","ngForOf","ngForTrackBy"],["class","loading-wrapper",4,"ngIf"],[1,"input-container"],[1,"input-wrapper"],["placeholder","Type your message...","name","message","autocomplete","off",1,"message-input",3,"ngModelChange","keypress","ngModel","disabled"],[1,"send-button",3,"click","disabled"],["class","send-icon",4,"ngIf"],["class","loading-spinner",4,"ngIf"],[1,"welcome-message"],[1,"message-wrapper",3,"ngClass"],[1,"message",3,"ngClass"],[1,"message-content"],[1,"message-text",3,"innerHTML"],[1,"message-time"],[1,"loading-wrapper"],[1,"loading-message"],[1,"typing-indicator"],[1,"typing-text"],[1,"send-icon"],[1,"fa-solid","fa-paper-plane"],[1,"loading-spinner"],[1,"fa-solid","fa-circle-notch","fa-spin"]],template:function(i,n){if(i&1){let o=D();a(0,"div",2)(1,"div",3,0),y(3,We,5,0,"div",4)(4,Ye,7,13,"div",5)(5,Xe,8,0,"div",6),s(),a(6,"div",7)(7,"div",8)(8,"input",9,1),se("ngModelChange",function(g){return f(o),ae(n.msg,g)||(n.msg=g),b(g)}),C("keypress",function(g){return f(o),b(n.onKeyPress(g))}),s(),a(10,"button",10),C("click",function(){return f(o),b(n.sendMessage())}),y(11,je,2,0,"span",11)(12,Le,2,0,"span",12),s()()()()}i&2&&(l(3),d("ngIf",n.messages.length===0),l(),d("ngForOf",n.messages)("ngForTrackBy",n.trackByMessage),l(),d("ngIf",n.isLoading),l(3),oe("ngModel",n.msg),d("disabled",n.isLoading),l(2),I("loading",n.isLoading),d("disabled",!n.msg.trim()||n.isLoading),l(),d("ngIf",!n.isLoading),l(),d("ngIf",n.isLoading))},dependencies:[P,ge,me,S,ce,De,ke,Me,Ie],styles:['.chatbot-container[_ngcontent-%COMP%]{display:flex;flex-direction:column;height:100%;background:linear-gradient(to bottom,#0c0f20,#000);border-radius:16px;overflow:hidden;box-shadow:0 20px 40px #0000004d;position:relative}.chatbot-container[_ngcontent-%COMP%]:before{content:"";position:absolute;top:0;left:0;right:0;height:1px;background:linear-gradient(90deg,transparent,#dabe64,transparent)}.messages-container[_ngcontent-%COMP%]{flex:1;padding:24px;overflow-y:auto;display:flex;flex-direction:column;gap:16px;scroll-behavior:smooth}.messages-container[_ngcontent-%COMP%]::-webkit-scrollbar{width:6px}.messages-container[_ngcontent-%COMP%]::-webkit-scrollbar-track{background:#0000001a;border-radius:3px}.messages-container[_ngcontent-%COMP%]::-webkit-scrollbar-thumb{background:linear-gradient(to bottom,#746535,#dabe64);border-radius:3px}.messages-container[_ngcontent-%COMP%]::-webkit-scrollbar-thumb:hover{background:linear-gradient(to bottom,#dabe64,#746535)}.welcome-message[_ngcontent-%COMP%]{text-align:center;padding:32px 20px;background:linear-gradient(135deg,#dabe641a,#7465351a);border:1px solid rgba(218,190,100,.3);border-radius:16px;margin-bottom:16px;-webkit-backdrop-filter:blur(10px);backdrop-filter:blur(10px)}.welcome-icon[_ngcontent-%COMP%]{margin-bottom:16px}.welcome-icon[_ngcontent-%COMP%]   i[_ngcontent-%COMP%]{font-size:2.5rem;color:#dabe64;filter:drop-shadow(0 0 10px rgba(218,190,100,.5))}.welcome-message[_ngcontent-%COMP%]   h3[_ngcontent-%COMP%]{color:#dabe64;margin:0 0 8px;font-size:1.5rem;font-weight:600}.welcome-message[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{color:#dabe64cc;margin:0;font-size:1rem}.message-wrapper[_ngcontent-%COMP%]{display:flex;animation:_ngcontent-%COMP%_slideIn .4s ease-out}.user-wrapper[_ngcontent-%COMP%]{justify-content:flex-end}.bot-wrapper[_ngcontent-%COMP%]{justify-content:flex-start}.message[_ngcontent-%COMP%]{max-width:75%;padding:16px 20px;border-radius:20px;position:relative;-webkit-backdrop-filter:blur(10px);backdrop-filter:blur(10px);transition:all .3s ease}.message[_ngcontent-%COMP%]:hover{transform:translateY(-2px);box-shadow:0 8px 20px #0000004d}.bot-message[_ngcontent-%COMP%]{background:linear-gradient(135deg,#1119,#1e1e1e99);color:#dabe64;border:1px solid rgba(218,190,100,.3);border-bottom-left-radius:6px;position:relative}.bot-message[_ngcontent-%COMP%]:before{content:"";position:absolute;left:-8px;bottom:0;width:0;height:0;border-style:solid;border-width:0 8px 12px 0;border-color:transparent rgba(218,190,100,.3) transparent transparent}.user-message[_ngcontent-%COMP%]{background:linear-gradient(135deg,#dabe6426,#74653526);color:#dabe64;border:1px solid rgba(218,190,100,.4);border-bottom-right-radius:6px;position:relative}.user-message[_ngcontent-%COMP%]:before{content:"";position:absolute;right:-8px;bottom:0;width:0;height:0;border-style:solid;border-width:0 0 12px 8px;border-color:transparent transparent rgba(218,190,100,.4) transparent}.message-content[_ngcontent-%COMP%]{display:flex;flex-direction:column}.message-text[_ngcontent-%COMP%]{line-height:1.5;word-wrap:break-word}.message-time[_ngcontent-%COMP%]{font-size:.7rem;opacity:.6;margin-top:8px;align-self:flex-end;color:#dabe64b3}.loading-wrapper[_ngcontent-%COMP%]{display:flex;justify-content:flex-start;animation:_ngcontent-%COMP%_slideIn .4s ease-out}.loading-message[_ngcontent-%COMP%]{display:flex;align-items:center;gap:12px;padding:16px 20px;background:linear-gradient(135deg,#1119,#1e1e1e99);border:1px solid rgba(218,190,100,.3);border-radius:20px 20px 20px 6px;-webkit-backdrop-filter:blur(10px);backdrop-filter:blur(10px)}.typing-indicator[_ngcontent-%COMP%]{display:flex;gap:4px}.typing-indicator[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{width:8px;height:8px;background:linear-gradient(45deg,#746535,#dabe64);border-radius:50%;animation:_ngcontent-%COMP%_typing 1.4s infinite ease-in-out}.typing-indicator[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]:nth-child(2){animation-delay:.2s}.typing-indicator[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]:nth-child(3){animation-delay:.4s}.typing-text[_ngcontent-%COMP%]{color:#dabe64cc;font-size:.9rem;font-style:italic}.input-container[_ngcontent-%COMP%]{padding:20px;background:linear-gradient(135deg,#0000004d,#1a1f2e4d);border-top:1px solid rgba(218,190,100,.2);-webkit-backdrop-filter:blur(10px);backdrop-filter:blur(10px)}.input-wrapper[_ngcontent-%COMP%]{display:flex;gap:12px;align-items:center}.message-input[_ngcontent-%COMP%]{flex:1;padding:14px 20px;border:2px solid rgba(218,190,100,.3);border-radius:25px;outline:none;font-size:15px;background:#0000004d;color:#dabe64;transition:all .3s ease;-webkit-backdrop-filter:blur(10px);backdrop-filter:blur(10px)}.message-input[_ngcontent-%COMP%]::placeholder{color:#dabe6480}.message-input[_ngcontent-%COMP%]:focus{border-color:#dabe64;box-shadow:0 0 0 3px #dabe6433;background:#0006}.send-button[_ngcontent-%COMP%]{width:52px;height:52px;border-radius:50%;background:linear-gradient(135deg,#746535,#dabe64);color:#fff;border:none;display:flex;align-items:center;justify-content:center;transition:all .3s ease;cursor:pointer;position:relative;overflow:hidden}.send-button[_ngcontent-%COMP%]:before{content:"";position:absolute;inset:0;background:linear-gradient(135deg,#dabe64,#746535);opacity:0;transition:opacity .3s ease}.send-button[_ngcontent-%COMP%]:hover:not(:disabled):before{opacity:1}.send-button[_ngcontent-%COMP%]:hover:not(:disabled){transform:translateY(-2px);box-shadow:0 8px 20px #dabe644d}.send-button[_ngcontent-%COMP%]:disabled{opacity:.5;cursor:not-allowed;transform:none}.send-icon[_ngcontent-%COMP%], .loading-spinner[_ngcontent-%COMP%]{position:relative;z-index:2;font-size:1.1rem}.send-button.loading[_ngcontent-%COMP%]{animation:_ngcontent-%COMP%_pulse 1s infinite}@keyframes _ngcontent-%COMP%_slideIn{0%{opacity:0;transform:translateY(15px)}to{opacity:1;transform:translateY(0)}}@keyframes _ngcontent-%COMP%_typing{0%,60%,to{transform:translateY(0);opacity:.5}30%{transform:translateY(-8px);opacity:1}}@keyframes _ngcontent-%COMP%_pulse{0%,to{transform:scale(1)}50%{transform:scale(1.05)}}@media (max-width: 768px){.chatbot-container[_ngcontent-%COMP%]{border-radius:12px}.messages-container[_ngcontent-%COMP%]{padding:16px}.message[_ngcontent-%COMP%]{max-width:85%;padding:12px 16px}.input-container[_ngcontent-%COMP%]{padding:16px}.message-input[_ngcontent-%COMP%]{padding:12px 16px;font-size:14px}.send-button[_ngcontent-%COMP%]{width:46px;height:46px}}']})};var ze=["sprite"];function Ne(t,e){if(t&1&&(a(0,"div",5),m(1),s()),t&2){let i=te();l(),ne(" ",i.dialog," ")}}var B=class t{spriteRef;frameRate=24;animation="idle";config={assetBasePath:"https://assets.l2terra.online/sprites/Skeleton_Crusader_1/PNG/PNG%20Sequences/",defaultFrameRate:24,movementSpeed:1.5,dragSmooth:1.12,movementSmooth:.04,idleSmooth:.95,gravity:3,maxFallSpeed:300,jumpPower:20,dragHoldMs:150,dragThreshold:5,minAutoWalkDistance:80,moveCheckInterval:50,dialogMessageIntervalMs:8e3,dialogDuration:3e3,dialogFadeTime:500,selectionGlowColor:"#FFD700",selectionGlowIntensity:15,dragScale:1.1,dragShadow:"0 10px 20px rgba(0, 0, 0, 0.4)",initialX:350,initialY:0,spriteWidth:100,spriteHeight:100,enableAutoWalk:!0,enableAutoBlink:!0,enableRandomDialog:!0,enableDragAndDrop:!0,enableClick:!0,useSimpleDrag:!0,enableJump:!0,autoWalkInterval:6e3,autoBlinkInterval:4e3,randomDialogInterval:6e3,blinkDuration:600,fallAnimationDuration:800,deathAnimationDuration:1500,kickAnimationDuration:600,fallDistance:60,fallSteps:25,defaultDialog:"Hello, I'm the Skeleton Crusader!",dialogMessages:["Our Terra server is under development!","Click here for more information!","Stay tuned for upcoming updates!","Have questions? Tap me!","Join our Discord for more info!","Drag and drop me!","Click on me!","Let's go for a walk!"],animations:{dying:{folder:"Dying",frames:15},fallingDown:{folder:"Falling Down",frames:6},hurt:{folder:"Hurt",frames:12},idle:{folder:"Idle",frames:18},idleBlinking:{folder:"Idle Blinking",frames:18},jumpLoop:{folder:"Jump Loop",frames:6},jumpStart:{folder:"Jump Start",frames:6},kicking:{folder:"Kicking",frames:12},runSlashing:{folder:"Run Slashing",frames:12},runThrowing:{folder:"Run Throwing",frames:12},running:{folder:"Running",frames:12},slashing:{folder:"Slashing",frames:12},slashingInTheAir:{folder:"Slashing in The Air",frames:12},sliding:{folder:"Sliding",frames:6},throwing:{folder:"Throwing",frames:12},throwingInTheAir:{folder:"Throwing in The Air",frames:12},walking:{folder:"Walking",frames:24}}};currentFrame=0;totalFrames=18;intervalId;movementIntervalId;_frameTime=0;_lastFrameTimestamp=performance.now();_animationFrameId;currentX=this.config.initialX;currentY=this.config.initialY;targetX=this.config.initialX;targetY=this.config.initialY;facingLeft=!1;spriteWidth=this.config.spriteWidth;spriteHeight=this.config.spriteHeight;screenWidth=window.innerWidth;screenHeight=window.innerHeight;state="idle";isLoaded=!1;isFalling=!1;fallSpeed=0;isJumping=!1;jumpVelocity=0;jumpPower=this.config.jumpPower;playOnce=!1;isBeingDragged=!1;isDragging=!1;isMouseDown=!1;mouseDownTime=0;startMouseX=0;startMouseY=0;startElementX=0;startElementY=0;dragOffsetX=0;dragOffsetY=0;selecting=!1;clickFired=!1;dragHoldTimeout=null;selectionEffect=!1;dragDistance=0;_autoWalkInterval=null;_autoWalkIntervalMs=this.config.autoWalkInterval;_autoWalkShouldResume=!1;_moveCheckInterval=null;_autoBlinkInterval=null;_randomDialogInterval=null;_blinkBackToIdle=!1;dialog="";dialogMessages=this.config.dialogMessages;dialogTimeout=null;get groundY(){return 0}onKeyDown(e){e.code==="Space"&&this.config.enableJump&&(e.preventDefault(),this.jump())}onWindowResize(){this.screenWidth=window.innerWidth,this.screenHeight=window.innerHeight}ngOnInit(){this.currentY=this.config.initialY,this.targetY=this.config.initialY,this.isLoaded=!0,this.applyCSSConfig(),this.startAnimation(),this.startMovement(),this.setDialog(this.config.defaultDialog,3e3),this.config.enableAutoBlink&&this.startAutoBlink(),this.config.enableRandomDialog&&this.startRandomDialog(),this.config.enableAutoWalk&&this.startAutoWalk()}ngOnChanges(e){e.animation&&this.setAnimation(this.animation)}ngOnDestroy(){this.cleanup()}cleanup(){this.intervalId&&clearInterval(this.intervalId),this.movementIntervalId&&clearInterval(this.movementIntervalId),this._animationFrameId&&cancelAnimationFrame(this._animationFrameId),this._autoWalkInterval&&clearInterval(this._autoWalkInterval),this._moveCheckInterval&&clearInterval(this._moveCheckInterval),this._autoBlinkInterval&&clearInterval(this._autoBlinkInterval),this._randomDialogInterval&&clearInterval(this._randomDialogInterval),this.dragHoldTimeout&&clearTimeout(this.dragHoldTimeout),this.dialogTimeout&&clearTimeout(this.dialogTimeout)}applyCSSConfig(){let e=this.spriteRef.nativeElement.parentElement?.parentElement;e&&(e.style.setProperty("--skeleton-sprite-width",`${this.config.spriteWidth}px`),e.style.setProperty("--skeleton-sprite-height",`${this.config.spriteHeight}px`),e.style.setProperty("--skeleton-drag-scale",this.config.dragScale.toString()),e.style.setProperty("--skeleton-drag-shadow",this.config.dragShadow),e.style.setProperty("--skeleton-selection-glow-color",this.config.selectionGlowColor),e.style.setProperty("--skeleton-selection-glow-intensity",`${this.config.selectionGlowIntensity}px`)),this.ensureFixedPosition()}ensureFixedPosition(){let e=this.spriteRef.nativeElement.parentElement;e&&(e.style.position="fixed",e.style.bottom=this.currentY+"px",e.style.left=this.currentX+"px",e.style.transition="none",e.style.zIndex="1000")}startAnimation(){this._animationFrameId&&cancelAnimationFrame(this._animationFrameId);let e=i=>{let o=1e3/(this.frameRate||this.config.defaultFrameRate);i-this._lastFrameTimestamp>=o&&(this.update(),this._lastFrameTimestamp=i),this._animationFrameId=requestAnimationFrame(e)};this._animationFrameId=requestAnimationFrame(e)}update(){if(!this.isLoaded)return;let e=this.config.animations[this.animation];if(!e){this.setAnimation("idle");return}this.currentFrame=(this.currentFrame+1)%e.frames,this._blinkBackToIdle&&this.animation==="idleBlinking"&&this.currentFrame===e.frames-1&&(this.setAnimation("idle"),this._blinkBackToIdle=!1),this.updatePhysics(),this.updateMovement(),this.updatePosition()}updatePhysics(){this.isJumping&&(this.jumpVelocity+=this.config.gravity,this.currentY+=this.jumpVelocity,this.jumpVelocity>0&&this.animation==="jumpStart"&&this.setAnimation("jumpLoop"),this.currentY<=this.groundY&&(this.currentY=this.groundY,this.targetY=this.groundY,this.isJumping=!1,this.jumpVelocity=0,this.setAnimation("idle"),this.state="idle",this.setDialog("I landed!",1e3))),this.isFalling&&!this.isDragging&&(this.fallSpeed+=this.config.gravity,this.fallSpeed>this.config.maxFallSpeed&&(this.fallSpeed=this.config.maxFallSpeed),this.currentY-=this.fallSpeed,this.currentY<=this.groundY&&(this.currentY=this.groundY,this.targetY=this.groundY,this.isFalling=!1,this.fallSpeed=0,this.setAnimation("hurt",!0),this.setDialog("Ouch! That hurt!",2e3),setTimeout(()=>{this.setAnimation("idle"),this.state="idle"},1e3)))}updateMovement(){if(this.isDragging||this.isFalling)return;let e=this.config.idleSmooth;if(this.state==="moving"){e=this.config.movementSmooth;let i=this.targetX-this.currentX,n=this.targetY-this.currentY;Math.sqrt(i*i+n*n)<5&&(this.setAnimation("idle"),this.state="idle",this._moveCheckInterval&&(clearInterval(this._moveCheckInterval),this._moveCheckInterval=null))}this.currentX+=(this.targetX-this.currentX)*e,this.currentY+=(this.targetY-this.currentY)*e}startMovement(){this.movementIntervalId&&clearInterval(this.movementIntervalId),this.movementIntervalId=setInterval(()=>{this.updateScreenSize()},100)}updateScreenSize(){this.screenWidth=window.innerWidth,this.screenHeight=window.innerHeight}updatePosition(){let e=this.spriteRef.nativeElement.parentElement;e&&!this.isDragging&&(this.currentX=Math.max(0,Math.min(this.screenWidth-this.spriteWidth,this.currentX)),this.currentY=Math.max(0,this.currentY),e.style.position="fixed",e.style.left=this.currentX+"px",e.style.bottom=this.currentY+"px",e.style.transition="none",this.flipSprite())}flipSprite(){let e=this.spriteRef.nativeElement;e&&(e.style.transform=this.facingLeft?"scaleX(-1)":"scaleX(1)")}setAnimation(e,i=!1){this.config.animations[e]&&(this.animation=e,this.currentFrame=0,this.playOnce=i,e==="idleBlinking"&&i?this._blinkBackToIdle=!0:this._blinkBackToIdle=!1)}jump(){!this.isJumping&&!this.isFalling&&this.state!=="dying"&&this.config.enableJump&&(this.isJumping=!0,this.jumpVelocity=-this.config.jumpPower,this.setAnimation("jumpStart"),this.state="jumping",this.setDialog("Jump!",1e3),this.pauseAutoWalk())}startFalling(){this.isFalling=!0,this.fallSpeed=0,this.state="falling",this.setAnimation("fallingDown"),this.setDialog("I'm falling!",1500),this.pauseAutoWalk()}moveTo(e,i=this.groundY){this.targetX=Math.max(0,Math.min(this.screenWidth-this.spriteWidth,e)),this.targetY=Math.max(this.groundY,i),this.facingLeft=this.targetX<this.currentX,this.state==="idle"&&!this.isJumping&&!this.isFalling&&(this.setAnimation("running"),this.state="moving")}startAutoWalk(){this._autoWalkInterval||!this.config.enableAutoWalk||(this._autoWalkInterval=setInterval(()=>{if(this.state==="idle"&&!this.isDragging&&!this.isJumping&&!this.isFalling){let i=this.screenWidth-this.spriteWidth-50,n;do n=Math.floor(Math.random()*(i-50+1))+50;while(Math.abs(this.currentX-n)<this.config.minAutoWalkDistance);this.moveTo(n)}},this.config.autoWalkInterval))}pauseAutoWalk(){this._autoWalkInterval&&(clearInterval(this._autoWalkInterval),this._autoWalkInterval=null,this._autoWalkShouldResume=!0)}resumeAutoWalk(){this._autoWalkShouldResume&&this.config.enableAutoWalk&&(this.startAutoWalk(),this._autoWalkShouldResume=!1)}startAutoBlink(){this._autoBlinkInterval||(this._autoBlinkInterval=setInterval(()=>{this.state==="idle"&&this.animation==="idle"&&this.setAnimation("idleBlinking",!0)},this.config.autoBlinkInterval+Math.random()*2e3))}startRandomDialog(){this._randomDialogInterval||(this._randomDialogInterval=setInterval(()=>{if(this.dialogMessages&&this.dialogMessages.length>0&&!this.dialog){let e=Math.floor(Math.random()*this.dialogMessages.length);this.setDialog(this.dialogMessages[e],this.config.dialogDuration)}},this.config.randomDialogInterval))}setDialog(e,i){this.dialogTimeout&&clearTimeout(this.dialogTimeout),this.dialog=e,i&&(this.dialogTimeout=setTimeout(()=>{let n=document.querySelector(".dialog-bubble");n?(n.style.opacity="0",setTimeout(()=>{this.dialog=""},200)):this.dialog=""},i))}getFrameSrc(){let e=this.config.animations[this.animation];if(!e)return"";let i=this.currentFrame.toString().padStart(3,"0"),n=`${this.config.assetBasePath}${e.folder}/0_Skeleton_Crusader_${e.folder}_${i}.png`;return encodeURI(n)}onMouseDown(e){if(!this.config.enableDragAndDrop&&!this.config.enableClick)return;e.preventDefault(),e.stopPropagation(),this.isMouseDown=!0,this.mouseDownTime=Date.now(),this.startMouseX=e.clientX,this.startMouseY=e.clientY,this.dragDistance=0,this.clickFired=!1;let i=this.spriteRef.nativeElement.parentElement?.getBoundingClientRect();i&&(this.startElementX=this.currentX,this.startElementY=this.currentY,this.dragOffsetX=e.clientX-i.left,this.dragOffsetY=e.clientY-i.top),this.selecting=!0,this.selectionEffect=!0,this.config.enableDragAndDrop&&this.config.useSimpleDrag&&(this.dragHoldTimeout=setTimeout(()=>{this.isMouseDown&&!this.isDragging&&this.startDragging()},this.config.dragHoldMs))}onMouseMove(e){if(!this.isMouseDown)return;let i=e.clientX-this.startMouseX,n=e.clientY-this.startMouseY;this.dragDistance=Math.sqrt(i*i+n*n),this.dragDistance>this.config.dragThreshold&&!this.isDragging&&this.config.enableDragAndDrop&&this.startDragging(),this.isDragging&&this.updateDragPosition(e)}onMouseUp(e){this.dragHoldTimeout&&(clearTimeout(this.dragHoldTimeout),this.dragHoldTimeout=null),this.selecting&&!this.isDragging&&!this.clickFired&&this.config.enableClick&&this.handleClick(),this.isDragging&&this.endDragging(),this.resetMouseState()}onMouseLeave(e){this.isDragging&&this.endDragging(),this.resetMouseState()}startDragging(){this.isDragging||(this.isDragging=!0,this.isBeingDragged=!0,this.clickFired=!0,this.selecting=!1,this.selectionEffect=!1,this.setAnimation("slashing"),this.setDialog("I'm being dragged!",2e3),this.pauseAutoWalk())}updateDragPosition(e){let i=e.clientX-this.dragOffsetX,n=this.screenHeight-(e.clientY-this.dragOffsetY)-this.spriteHeight;this.currentX=Math.max(0,Math.min(this.screenWidth-this.spriteWidth,i)),this.currentY=Math.max(0,n);let o=this.spriteRef.nativeElement.parentElement;o&&(o.style.position="fixed",o.style.left=this.currentX+"px",o.style.bottom=this.currentY+"px",o.style.transition="none",o.style.zIndex="1001")}endDragging(){this.isDragging=!1,this.isBeingDragged=!1,this.currentY>this.groundY?this.startFalling():(this.setAnimation("idle"),this.state="idle",this.setDialog("I'm not being dragged anymore!",1500),this.resumeAutoWalk()),this.targetX=this.currentX,this.targetY=this.currentY}handleClick(){this.setAnimation("kicking",!0),this.setDialog("Click! Hello!",2e3),setTimeout(()=>{this.animation==="kicking"&&this.setAnimation("idle")},this.config.kickAnimationDuration);let e=new CustomEvent("skeletonClick",{detail:{x:this.currentX,y:this.currentY}});this.spriteRef.nativeElement.parentElement?.dispatchEvent(e)}resetMouseState(){this.isMouseDown=!1,this.selecting=!1,this.selectionEffect=!1,this.dragDistance=0,this.dragHoldTimeout&&(clearTimeout(this.dragHoldTimeout),this.dragHoldTimeout=null)}onImageError(e){let i=e.target}die(){this.setAnimation("dying",!0),this.state="dying",this.setDialog("I'm dying!",2500),setTimeout(()=>{this.setAnimation("idle"),this.state="idle",this.setDialog("I'm alive again!",2e3)},this.config.deathAnimationDuration)}play(e){this.setAnimation(e),this.state="custom"}addDialogMessage(e){this.dialogMessages||(this.dialogMessages=[]),this.dialogMessages.push(e)}setDialogMessages(e){this.dialogMessages=Array.isArray(e)?e:[e]}static \u0275fac=function(i){return new(i||t)};static \u0275cmp=v({type:t,selectors:[["app-bot-sprite"]],viewQuery:function(i,n){if(i&1&&_(ze,7),i&2){let o;w(o=x())&&(n.spriteRef=o.first)}},hostBindings:function(i,n){i&1&&C("keydown",function(r){return n.onKeyDown(r)},!1,R)("resize",function(r){return n.onWindowResize(r)},!1,R)("mousedown",function(r){return n.onMouseDown(r)})("mousemove",function(r){return n.onMouseMove(r)},!1,W)("mouseup",function(r){return n.onMouseUp(r)},!1,W)("mouseleave",function(r){return n.onMouseLeave(r)})},inputs:{frameRate:"frameRate",animation:"animation"},features:[Q],decls:5,vars:8,consts:[["sprite",""],[1,"skeleton-wrapper"],[1,"sprite-container"],["class","dialog-bubble",4,"ngIf"],[1,"sprite",3,"error","src","alt"],[1,"dialog-bubble"]],template:function(i,n){if(i&1){let o=D();a(0,"div",1)(1,"div",2),y(2,Ne,2,1,"div",3),a(3,"img",4,0),C("error",function(g){return f(o),b(n.onImageError(g))}),s()()()}i&2&&(l(),I("dragging",n.isDragging)("selecting",n.selecting),ee("data-draggable",n.config.enableDragAndDrop),l(),d("ngIf",n.dialog),l(),d("src",n.getFrameSrc(),q)("alt",n.animation))},dependencies:[P,S],styles:['[_nghost-%COMP%]{display:inline-block;position:fixed;bottom:0;left:0;-webkit-user-select:none;user-select:none;z-index:10;cursor:grab;transition:none;will-change:transform;pointer-events:auto;--skeleton-sprite-width: 100px;--skeleton-sprite-height: 100px;--skeleton-drag-scale: 1.05;--skeleton-drag-shadow: 0 8px 16px rgba(0, 0, 0, .3);--skeleton-selection-glow-color: #FFD700;--skeleton-selection-glow-intensity: 20px;--skeleton-dialog-bg-color: rgba(0, 0, 0, .8);--skeleton-dialog-text-color: white;--skeleton-shadow-color: rgba(0, 0, 0, .3)}.skeleton-wrapper[_ngcontent-%COMP%]{position:relative;display:inline-block}.sprite-container[_ngcontent-%COMP%]{display:block;position:relative;transition:none;pointer-events:auto}.sprite-container.dragging[_ngcontent-%COMP%]{cursor:grabbing;filter:drop-shadow(var(--skeleton-drag-shadow));transform:scale(var(--skeleton-drag-scale));z-index:1000}.sprite-container.selecting[_ngcontent-%COMP%]{cursor:pointer;filter:drop-shadow(0 0 var(--skeleton-selection-glow-intensity) var(--skeleton-selection-glow-color))}.sprite[_ngcontent-%COMP%]{display:block;width:var(--skeleton-sprite-width);height:var(--skeleton-sprite-height);image-rendering:pixelated;image-rendering:-moz-crisp-edges;image-rendering:crisp-edges;-webkit-user-select:none;user-select:none;pointer-events:none;transition:none}.dialog-bubble[_ngcontent-%COMP%]{position:absolute;top:-50px;left:50%;transform:translate(-50%);background:var(--skeleton-dialog-bg-color);color:var(--skeleton-dialog-text-color);padding:10px 15px;border-radius:20px;font-size:14px;font-weight:500;font-family:Segoe UI,Tahoma,Geneva,Verdana,sans-serif;white-space:nowrap;z-index:1001;pointer-events:none;box-shadow:0 4px 12px #0000004d;max-width:200px;text-align:center;animation:_ngcontent-%COMP%_dialogFadeIn .3s ease-out;transition:opacity .2s ease-out}.dialog-bubble[_ngcontent-%COMP%]:after{content:"";position:absolute;bottom:-8px;left:50%;transform:translate(-50%);width:0;height:0;border-left:8px solid transparent;border-right:8px solid transparent;border-top:8px solid var(--skeleton-dialog-bg-color)}@keyframes _ngcontent-%COMP%_dialogFadeIn{0%{opacity:0;transform:translate(-50%) translateY(-10px)}to{opacity:1;transform:translate(-50%) translateY(0)}}.sprite-container[_ngcontent-%COMP%]:before{content:"";position:absolute;bottom:-10px;left:50%;transform:translate(-50%);width:60px;height:15px;background:var(--skeleton-shadow-color);border-radius:50%;z-index:-1}.cdk-drag-preview[_ngcontent-%COMP%]{box-sizing:border-box;border-radius:4px;box-shadow:0 5px 5px -3px #0003,0 8px 10px 1px #00000024,0 3px 14px 2px #0000001f}.cdk-drag-placeholder[_ngcontent-%COMP%]{opacity:0}.cdk-drag-animating[_ngcontent-%COMP%]{transition:transform .25s cubic-bezier(0,0,.2,1)}.cdk-drag-disabled[_ngcontent-%COMP%]{cursor:default!important}']})};var H=class t{static \u0275fac=function(i){return new(i||t)};static \u0275cmp=v({type:t,selectors:[["app-root"]],decls:11,vars:0,consts:[["tabindex","-1","id","offCanvasChat","aria-labelledby","offCanvasChatLabel",1,"offcanvas","offcanvas-end","chatbot-container"],["src","","alt","","srcset",""],[1,"offcanvas-header"],["id","offCanvasChatLabel",1,"offcanvas-title"],[1,"fa-solid","fa-robot"],["type","button","data-bs-dismiss","offcanvas","aria-label","Cerrar",1,"btn-close","text-reset"],[1,"offcanvas-body","p-0"],["data-bs-toggle","offcanvas","data-bs-target","#offCanvasChat"]],template:function(i,n){i&1&&(p(0,"router-outlet"),a(1,"div",0),p(2,"img",1),a(3,"div",2)(4,"h5",3),p(5,"i",4),m(6," Terra Assistant"),s(),p(7,"button",5),s(),a(8,"div",6),p(9,"app-botterra"),s()(),p(10,"app-bot-sprite",7))},dependencies:[ye,E,B],styles:['.button-assistant[_ngcontent-%COMP%]{position:fixed;bottom:10%;right:50px;z-index:999;width:60px;height:60px;padding:10px;font-size:24px;background:linear-gradient(to right,#746535,#dabe64);color:#fff;border:none;border-radius:50%;box-shadow:0 2px 8px #0000004d;display:flex;align-items:center;justify-content:center;transition:transform .2s ease}.button-assistant[_ngcontent-%COMP%]:hover{transform:scale(1.05);padding:15px}.chatbot-container[_ngcontent-%COMP%]{background:linear-gradient(to bottom,#0c0f20,#000)}.offcanvas-title[_ngcontent-%COMP%]{color:#dabe64}.btn-close[_ngcontent-%COMP%]{filter:none!important;background-image:none!important;color:#dabe64!important;font-size:1.5rem;position:relative}.btn-close[_ngcontent-%COMP%]:before{content:"\\d7";color:#dabe64;position:absolute;top:50%;left:50%;transform:translate(-50%,-50%);font-weight:700;font-size:2.5rem}']})};he(H,Te).catch(t=>console.error(t));
