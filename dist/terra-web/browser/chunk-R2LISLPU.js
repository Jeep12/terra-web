import{a as z}from"./chunk-MLZ77VUB.js";import{b as I,c as v,d as L,e as G,h as A,j as R,k as N,r as j,t as q}from"./chunk-THFTEXFF.js";import{b as E,c as P,d as M,f as O,g as S,i as F,o as T,t as V}from"./chunk-OOGZQ4YG.js";import{$ as f,Ba as s,Fa as w,Ga as _,La as k,Qa as g,V as b,Xa as c,aa as u,ab as n,bb as r,cb as a,d as x,fb as h,ib as p,jb as d,lb as m,nb as y,ya as C}from"./chunk-Y3DSR7KR.js";function D(i,o){i&1&&(n(0,"span"),m(1," Email is required "),r())}function W(i,o){i&1&&(n(0,"span"),m(1," Please enter a valid email "),r())}function Y(i,o){if(i&1&&(n(0,"div",28),g(1,D,2,0,"span",29)(2,W,2,0,"span",29),r()),i&2){let e,t,l=d(2);s(),c("ngIf",(e=l.emailForm.get("email"))==null||e.errors==null?null:e.errors.required),s(),c("ngIf",(t=l.emailForm.get("email"))==null||t.errors==null?null:t.errors.email)}}function H(i,o){if(i&1){let e=h();n(0,"div",12)(1,"form",13),p("ngSubmit",function(){f(e);let l=d();return u(l.goToNextStep())}),n(2,"div",14)(3,"label",15),a(4,"i",16),m(5," Email address "),r(),a(6,"input",17),g(7,Y,3,2,"div",18),r(),n(8,"button",19),m(9," Next "),a(10,"i",20),r()(),n(11,"div",21)(12,"p",22)(13,"span"),m(14,"Or continue with"),r()(),n(15,"div",23)(16,"button",24),p("click",function(){f(e);let l=d();return u(l.loginWithGoogle())}),a(17,"i",25),m(18," \xA0 Google "),r(),n(19,"button",26),p("click",function(){f(e);let l=d();return u(l.loginWithFacebook())}),a(20,"i",27),m(21," \xA0Facebook "),r()()()()}if(i&2){let e,t=d();s(),c("formGroup",t.emailForm),s(6),c("ngIf",((e=t.emailForm.get("email"))==null?null:e.invalid)&&((e=t.emailForm.get("email"))==null?null:e.touched)),s(),c("disabled",t.emailForm.invalid)}}function U(i,o){i&1&&(n(0,"span"),m(1," Password is required "),r())}function J(i,o){if(i&1&&(n(0,"div",28),g(1,U,2,0,"span",29),r()),i&2){let e,t=d(2);s(),c("ngIf",(e=t.passwordForm.get("password"))==null||e.errors==null?null:e.errors.required)}}function $(i,o){if(i&1&&(n(0,"li"),a(1,"i",45),m(2),r()),i&2){let e=o.$implicit;s(2),y(" ",e," ")}}function K(i,o){if(i&1&&(n(0,"div",42)(1,"ul",43),g(2,$,3,1,"li",44),r()()),i&2){let e=d(2);s(2),c("ngForOf",e.errors)}}function Q(i,o){if(i&1){let e=h();n(0,"button",46),p("click",function(){f(e);let l=d(2);return u(l.navigateToResendEmailVerification())}),a(1,"i",39),m(2," Go to Resend Email Verification "),r()}}function X(i,o){if(i&1){let e=h();n(0,"div",12)(1,"form",13),p("ngSubmit",function(){f(e);let l=d();return u(l.login())}),n(2,"div",14)(3,"label",30),a(4,"i",31),m(5," Password "),r(),n(6,"div",32),a(7,"input",33),n(8,"button",34),p("click",function(){f(e);let l=d();return u(l.togglePasswordVisibility())}),a(9,"i",35),r()(),g(10,J,2,1,"div",18),r(),g(11,K,3,1,"div",36),n(12,"button",19),m(13," Login "),a(14,"i",37),r(),a(15,"hr"),n(16,"button",38),p("click",function(){f(e);let l=d();return u(l.goToBack())}),a(17,"i",39),m(18," Back"),r(),a(19,"br")(20,"br")(21,"div",40),g(22,Q,3,0,"button",41),r()()}if(i&2){let e,t=d();s(),c("formGroup",t.passwordForm),s(6),c("type",t.passwordVisible?"text":"password"),s(2),c("ngClass",t.passwordVisible?"fa-eye-slash":"fa-eye"),s(),c("ngIf",((e=t.passwordForm.get("password"))==null?null:e.invalid)&&((e=t.passwordForm.get("password"))==null?null:e.touched)),s(),c("ngIf",t.errors.length>0),s(),c("disabled",t.passwordForm.invalid),s(10),c("ngIf",t.btnGoToResendEmailVerification)}}var B=class i{constructor(o,e,t,l,Z){this.fb=o;this.router=e;this.http=t;this.authService=l;this.renderer=Z;this.emailForm=this.fb.group({email:["",[v.required,v.email]]}),this.passwordForm=this.fb.group({password:["",[v.required]]})}emailForm;passwordForm;errors=[];currentStep=1;btnGoToResendEmailVerification=!1;userEmail="";passwordVisible=!1;googleAuth=b(z);isLoading=!1;errorMessage="";ngOnInit(){let o=document.querySelector(".auth-container"),e=localStorage.getItem("theme");o&&(e==="dark"?this.renderer.addClass(o,"dark-mode"):this.renderer.removeClass(o,"dark-mode"))}goToNextStep(){this.emailForm.valid?(this.userEmail=this.emailForm.get("email")?.value,this.currentStep=2):this.emailForm.markAllAsTouched()}getEmail(){return this.emailForm.get("email")?.value}goToBack(){this.currentStep=1}login(){if(this.errors=[],this.btnGoToResendEmailVerification=!1,this.passwordForm.valid&&this.userEmail){let o={email:this.userEmail,password:this.passwordForm.get("password")?.value};this.authService.login(o).subscribe({next:e=>{this.btnGoToResendEmailVerification=!1,this.authService.setEmail(this.userEmail),this.router.navigate(["/dashboard"])},error:e=>{e.error?.error==="EMAIL_NOT_VERIFIED"?(this.btnGoToResendEmailVerification=!0,this.errors.push("Your email is not verified. Please verify it or resend verification email.")):(this.btnGoToResendEmailVerification=!1,this.errors.push(e.error?.message||"Login failed"))}})}else this.btnGoToResendEmailVerification=!1,this.userEmail||alert("Email is required"),this.passwordForm.markAllAsTouched()}navigateToResendEmailVerification(){this.router.navigate(["/resend-email-verification"],{queryParams:{email:this.userEmail}})}loginWithGoogle(){return x(this,null,function*(){this.isLoading=!0,this.errorMessage="";try{let o=yield this.googleAuth.signInWithGoogle();this.router.navigate(["/dashboard"])}catch(o){this.errorMessage="Error al iniciar sesi\xF3n con Google",console.error("Error completo:",o)}finally{this.isLoading=!1}})}loginWithFacebook(){return x(this,null,function*(){this.isLoading=!0,this.errorMessage="";try{let o=yield this.googleAuth.signInWithFacebook();this.router.navigate(["/dashboard"])}catch(o){this.errorMessage="Error al iniciar sesi\xF3n con Facebook",console.error("Error completo:",o)}finally{this.isLoading=!1}})}navigateToForgotPassword(){this.router.navigate(["/forgot-password"])}navigateToRegister(){this.router.navigate(["/register"])}togglePasswordVisibility(){this.passwordVisible=!this.passwordVisible}static \u0275fac=function(e){return new(e||i)(_(j),_(T),_(F),_(V),_(w))};static \u0275cmp=k({type:i,selectors:[["app-login"]],decls:18,vars:2,consts:[[1,"auth-container"],["rel","preconnect","href",C`https://assets.l2terra.online`],[1,"logo-container"],["ngSrc","https://assets.l2terra.online/logoJuanLineage_baja_enBlanco.webp","fill","","alt","Logo de Terra","priority",""],[1,"auth-card"],[1,"auth-title"],[1,"fa-solid","fa-user"],["class","form-step",4,"ngIf"],[1,"auth-links"],[1,"auth-link",3,"click"],[1,"fas","fa-question-circle"],[1,"fas","fa-user-plus"],[1,"form-step"],[3,"ngSubmit","formGroup"],[1,"form-group"],["for","email"],[1,"fas","fa-envelope"],["type","email","id","email","formControlName","email","placeholder"," Enter your email",1,"form-control"],["class","error-message",4,"ngIf"],["type","submit",1,"btn-primary",3,"disabled"],[1,"fas","fa-arrow-right"],[1,"social-login"],[1,"divider"],[1,"social-buttons"],["type","button",1,"btn-social","google",3,"click"],[1,"fab","fa-google","social-icon"],["type","button",1,"btn-social","facebook",3,"click"],[1,"fab","fa-facebook-f","social-icon"],[1,"error-message"],[4,"ngIf"],["for","password"],[1,"fas","fa-lock"],[1,"password-input-container"],["id","password","formControlName","password","placeholder","Enter your password",1,"form-control",3,"type"],["type","button",1,"password-toggle",3,"click"],[1,"fas",3,"ngClass"],["class","alert alert-danger","role","alert",4,"ngIf"],[1,"fas","fa-sign-in-alt"],[1,"btn-secondary",3,"click"],[1,"fas","fa-arrow-left"],["data-sitekey","0x4AAAAAABhBLTkGwYdbEAbo",1,"cf-turnstile"],["ngClass","btn-secondary",3,"click",4,"ngIf"],["role","alert",1,"alert","alert-danger"],[1,"mb-0",2,"list-style","none","padding","0px"],[4,"ngFor","ngForOf"],[1,"fa-solid","fa-triangle-exclamation","text-danger"],["ngClass","btn-secondary",3,"click"]],template:function(e,t){e&1&&(n(0,"div",0)(1,"div"),a(2,"link",1),n(3,"div",2),a(4,"img",3),r()(),n(5,"div",4)(6,"h2",5),a(7,"i",6),m(8," Sign In to Your Account "),r(),g(9,H,22,3,"div",7)(10,X,23,7,"div",7),n(11,"div",8)(12,"a",9),p("click",function(){return t.navigateToForgotPassword()}),a(13,"i",10),m(14," Forgot password? "),r(),n(15,"a",9),p("click",function(){return t.navigateToRegister()}),a(16,"i",11),m(17," Create an account "),r()()()()),e&2&&(s(9),c("ngIf",t.currentStep===1),s(),c("ngIf",t.currentStep===2))},dependencies:[O,E,P,M,q,A,I,L,G,R,N,S],styles:['.auth-container[_ngcontent-%COMP%]{display:flex;flex-direction:column;justify-content:center;align-items:center;height:100%;padding:20px;background:linear-gradient(to bottom,#0c0f20,#000);font-family:Segoe UI,Tahoma,Geneva,Verdana,sans-serif;box-sizing:border-box}.auth-container.dark-mode[_ngcontent-%COMP%]{background:linear-gradient(to bottom,#121212,#000);color:#ddd}.logo-container[_ngcontent-%COMP%]{position:relative;width:350px;height:237px}.logo-container[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{width:100%;height:230px}.auth-card[_ngcontent-%COMP%]{background-color:#11111165;border-radius:12px;padding:30px;width:100%;max-width:400px;border:1px solid rgba(255,255,255,.1)}.auth-container.dark-mode[_ngcontent-%COMP%]   .auth-card[_ngcontent-%COMP%]{background-color:#1e1e1eb3;border-color:#555}.auth-title[_ngcontent-%COMP%]{color:#f9f9f9;text-align:center;margin-bottom:30px;font-weight:600;font-size:24px}.auth-container.dark-mode[_ngcontent-%COMP%]   .auth-title[_ngcontent-%COMP%]{color:#ccc}.form-group[_ngcontent-%COMP%]{margin-bottom:20px}label[_ngcontent-%COMP%]{display:block;margin-bottom:8px;color:#e0e0e0;font-size:14px}.auth-container.dark-mode[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]{color:#ccc}.form-control[_ngcontent-%COMP%]{width:100%;height:50px;border-radius:8px;border:1px solid rgba(255,255,255,.2);background-color:#ffffff12;color:#fff;font-size:16px;transition:all .3s ease;padding:0 12px}.form-control[_ngcontent-%COMP%]:focus{outline:none;border-color:#dabe64;box-shadow:0 0 0 2px #dabe6440}.form-control[_ngcontent-%COMP%]::placeholder{color:#fff6}.auth-container.dark-mode[_ngcontent-%COMP%]   .form-control[_ngcontent-%COMP%]{background-color:#3232324d;color:#eee;border-color:#666}.social-login[_ngcontent-%COMP%]{margin-top:24px}.divider[_ngcontent-%COMP%]{display:flex;align-items:center;text-align:center;color:#ffffff80;font-size:14px;margin:20px 0}.divider[_ngcontent-%COMP%]:before, .divider[_ngcontent-%COMP%]:after{content:"";flex:1;border-bottom:1px solid rgba(255,255,255,.2)}.divider[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{padding:0 10px}.social-buttons[_ngcontent-%COMP%]{display:flex;gap:12px}.btn-social[_ngcontent-%COMP%]{flex:1;padding:10px;border:1px solid rgba(255,255,255,.2);border-radius:8px;background-color:#ffffff12;color:#fff;font-size:14px;cursor:pointer;transition:all .3s ease;display:flex;align-items:center;justify-content:center}.btn-social[_ngcontent-%COMP%]:hover{background-color:#ffffff1f}.google[_ngcontent-%COMP%]{color:#db4437}.facebook[_ngcontent-%COMP%]{color:#4267b2}.auth-links[_ngcontent-%COMP%]{display:flex;justify-content:space-between;margin-top:24px;flex-wrap:wrap}.auth-link[_ngcontent-%COMP%], .terms-link[_ngcontent-%COMP%]{color:#dabe64;text-decoration:none;font-size:14px;cursor:pointer;transition:all .3s ease}.auth-link[_ngcontent-%COMP%]:hover, .terms-link[_ngcontent-%COMP%]:hover{text-decoration:underline}.error-message[_ngcontent-%COMP%]{color:#ff6b6b;font-size:12px;margin-top:5px}.form-step[_ngcontent-%COMP%]{animation:_ngcontent-%COMP%_fadeIn .3s ease-in-out}@keyframes _ngcontent-%COMP%_fadeIn{0%{opacity:0;transform:translateY(10px)}to{opacity:1;transform:translateY(0)}}@media (max-width: 480px){.auth-card[_ngcontent-%COMP%]{padding:20px}.form-control[_ngcontent-%COMP%]{padding:10px}.social-buttons[_ngcontent-%COMP%]{flex-direction:column}.auth-links[_ngcontent-%COMP%]{flex-direction:column;align-items:center;gap:10px}}']})};export{B as LoginComponent};
